<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-imports #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK hide, prune, not-home #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MLIR.AST.Dialect.Generated.Vector</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Bool</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Show</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ix</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.IArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IArray</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="MLIR.AST.html"><span class="hs-identifier">MLIR.AST</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="MLIR.AST.html#Attribute"><span class="hs-identifier">Attribute</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier">AbstractOperation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#ResultTypes"><span class="hs-identifier">ResultTypes</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier">Location</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#Signedness"><span class="hs-identifier">Signedness</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#DenseElements"><span class="hs-identifier">DenseElements</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier">NamedAttributes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#Name"><span class="hs-identifier">Name</span></a></span><span>
</span><span id="line-19"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier">NoAttrs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="MLIR.AST.html"><span class="hs-identifier">MLIR.AST</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AST</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html"><span class="hs-identifier">MLIR.AST.Builder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#EndOfBlock"><span class="hs-identifier">EndOfBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier">MonadBlockBuilder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#RegionBuilderT"><span class="hs-identifier">RegionBuilderT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html"><span class="hs-identifier">MLIR.AST.Builder</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AST</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="MLIR.AST.IStorableArray.html"><span class="hs-identifier">MLIR.AST.IStorableArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AST</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="MLIR.AST.PatternUtil.html"><span class="hs-identifier">MLIR.AST.PatternUtil</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PatternUtil</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Affine.html"><span class="hs-identifier">MLIR.AST.Dialect.Affine</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Affine</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- * vscale</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- $vscale</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- </span><span>
</span><span id="line-30"></span><span class="hs-comment">-- The @vscale@ op returns the scale of the scalable vectors, a positive</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- integer value that is constant at runtime but unknown at compile-time.</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- The scale of the vector indicates the multiplicity of the vectors and</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- vector operations. For example, a @vector\&lt;[4]xi32&gt;@ is equivalent to</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- @vscale@ consecutive @vector\&lt;4xi32&gt;@; and an operation on a</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- @vector\&lt;[4]xi32&gt;@ is equivalent to performing that operation @vscale@</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- times, once on each @\&lt;4xi32&gt;@ segment of the scalable vector. The @vscale@</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- op can be used to calculate the step in vector-length agnostic (VLA) loops.</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- Right now we only support one contiguous set of scalable dimensions, all of</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- them grouped and scaled with the value returned by \'vscale\'.</span><span>
</span><span id="line-40"></span><span class="hs-comment">--   </span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | A builder for @vector.vscale@.</span><span>
</span><span id="line-43"></span><span id="local-6989586621679448005"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#vscale"><span class="hs-identifier hs-type">vscale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-44"></span><span id="vscale"><span class="annot"><span class="annottext">vscale :: Type -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#vscale"><span class="hs-identifier hs-var hs-var">vscale</span></a></span></span><span> </span><span id="local-6989586621679448003"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679448003"><span class="hs-identifier hs-var">ty0</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-46"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.vscale&quot;</span></span><span>
</span><span id="line-47"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-48"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679448003"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- * bitcast</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- $bitcast</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- </span><span>
</span><span id="line-58"></span><span class="hs-comment">-- The bitcast operation casts between vectors of the same rank, the minor 1-D</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- vector size is casted to a vector with a different element type but same</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- bitwidth. In case of 0-D vectors, the bitwidth of element types must be</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- equal.</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- </span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- </span><span>
</span><span id="line-65"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- // Example casting to a smaller element type.</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- %1 = vector.bitcast %0 : vector\&lt;5x1x4x3xf32&gt; to vector\&lt;5x1x4x6xi16&gt;</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- </span><span>
</span><span id="line-69"></span><span class="hs-comment">-- // Example casting to a bigger element type.</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- %3 = vector.bitcast %2 : vector\&lt;10x12x8xi8&gt; to vector\&lt;10x12x2xi32&gt;</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- </span><span>
</span><span id="line-72"></span><span class="hs-comment">-- // Example casting to an element type of the same size.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- %5 = vector.bitcast %4 : vector\&lt;5x1x4x3xf32&gt; to vector\&lt;5x1x4x3xi32&gt;</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- </span><span>
</span><span id="line-75"></span><span class="hs-comment">-- // Example casting of 0-D vectors.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- %7 = vector.bitcast %6 : vector\&lt;f32&gt; to vector\&lt;i32&gt;</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-78"></span><span class="hs-comment">--   </span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | A pattern for @vector.bitcast@.</span><span>
</span><span id="line-81"></span><span id="local-6989586621679448144"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#BitCast"><span class="hs-identifier hs-type">BitCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448144"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448144"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bBitCast"><span id="%24mBitCast"><span id="BitCast"><span class="annot"><span class="annottext">$bBitCast :: Location -&gt; Type -&gt; operand -&gt; AbstractOperation operand
$mBitCast :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bBitCast"><span class="hs-identifier hs-var hs-var hs-var">BitCast</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447986"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447985"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447984"><span class="hs-identifier hs-type">source_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-83"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.bitcast&quot;</span></span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447986"><span class="annot"><a href="#local-6989586621679447986"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447985"><span class="annot"><a href="#local-6989586621679447985"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447984"><span class="annot"><a href="#local-6989586621679447984"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | A builder for @vector.bitcast@.</span><span>
</span><span id="line-93"></span><span id="local-6989586621679447983"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#bitcast"><span class="hs-identifier hs-type">bitcast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447983"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447983"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-94"></span><span id="bitcast"><span class="annot"><span class="annottext">bitcast :: Type -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#bitcast"><span class="hs-identifier hs-var hs-var">bitcast</span></a></span></span><span> </span><span id="local-6989586621679447981"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447981"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447980"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447980"><span class="hs-identifier hs-var">source_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-96"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.bitcast&quot;</span></span><span>
</span><span id="line-97"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-98"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447981"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447980"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- * broadcast</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- $broadcast</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- </span><span>
</span><span id="line-108"></span><span class="hs-comment">-- Broadcasts the scalar or k-D vector value in the source operand</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- to a n-D result vector such that the broadcast makes sense, i.e.,</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- the source operand is duplicated to match the given rank and sizes</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- in the result vector. The legality rules are:</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- * the source operand must have the same element type as the result type</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- * a k-D vector \&lt;s_1 x .. x s_k x type&gt; can be broadcast to</span><span>
</span><span id="line-114"></span><span class="hs-comment">--   a n-D vector \&lt;t_1 x .. x t_n x type&gt; if</span><span>
</span><span id="line-115"></span><span class="hs-comment">--    * k \&lt;= n, and</span><span>
</span><span id="line-116"></span><span class="hs-comment">--    * the sizes in the trailing dimensions n-k \&lt; i \&lt;= n with j=i+k-n</span><span>
</span><span id="line-117"></span><span class="hs-comment">--       match exactly as s_j = t_i or s_j = 1:</span><span>
</span><span id="line-118"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-119"></span><span class="hs-comment">--        t_1 x   ..  t_n-k x t_n-k+1 x .. x t_i x .. x t_n</span><span>
</span><span id="line-120"></span><span class="hs-comment">--                            s_1     x .. x s_j x .. x s_k</span><span>
</span><span id="line-121"></span><span class="hs-comment">--            \&lt;duplication&gt;         \&lt;potential stretch&gt;</span><span>
</span><span id="line-122"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- The source operand is duplicated over all the missing leading dimensions</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- and stretched over the trailing dimensions where the source has a non-equal</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- dimension of 1. These rules imply that any scalar broadcast (k=0) to any</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- shaped vector with the same element type is always legal.</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- </span><span>
</span><span id="line-128"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- </span><span>
</span><span id="line-130"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- %0 = arith.constant 0.0 : f32</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- %1 = vector.broadcast %0 : f32 to vector\&lt;16xf32&gt;</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- %2 = vector.broadcast %1 : vector\&lt;16xf32&gt; to vector\&lt;4x16xf32&gt;</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   </span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | A pattern for @vector.broadcast@.</span><span>
</span><span id="line-138"></span><span id="local-6989586621679447978"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Broadcast"><span class="hs-identifier hs-type">Broadcast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447978"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447978"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bBroadcast"><span id="%24mBroadcast"><span id="Broadcast"><span class="annot"><span class="annottext">$bBroadcast :: Location -&gt; Type -&gt; operand -&gt; AbstractOperation operand
$mBroadcast :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bBroadcast"><span class="hs-identifier hs-var hs-var hs-var">Broadcast</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447974"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447973"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447972"><span class="hs-identifier hs-type">source_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-140"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.broadcast&quot;</span></span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447974"><span class="annot"><a href="#local-6989586621679447974"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447973"><span class="annot"><a href="#local-6989586621679447973"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447972"><span class="annot"><a href="#local-6989586621679447972"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | A builder for @vector.broadcast@.</span><span>
</span><span id="line-150"></span><span id="local-6989586621679447971"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#broadcast"><span class="hs-identifier hs-type">broadcast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-151"></span><span id="broadcast"><span class="annot"><span class="annottext">broadcast :: Type -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#broadcast"><span class="hs-identifier hs-var hs-var">broadcast</span></a></span></span><span> </span><span id="local-6989586621679447969"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447969"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447968"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447968"><span class="hs-identifier hs-var">source_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.broadcast&quot;</span></span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-155"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447969"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447968"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- * compressstore</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- $compressstore</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- </span><span>
</span><span id="line-165"></span><span class="hs-comment">-- The compress store operation writes elements from a 1-D vector into memory</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- as defined by a base with indices and a 1-D mask vector. When the mask is</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- set, the corresponding element from the vector is written next to memory.</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Otherwise, no action is taken for the element. Informally the semantics are:</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- index = i</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- if (mask[0]) base[index++] = value[0]</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- if (mask[1]) base[index++] = value[1]</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Note that the index increment is done conditionally.</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- </span><span>
</span><span id="line-177"></span><span class="hs-comment">-- The compress store can be used directly where applicable, or can be used</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- hardware ISA support for a compress. The semantics of the operation closely</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- correspond to those of the @llvm.masked.compressstore@</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- intrinsic.</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- </span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- </span><span>
</span><span id="line-185"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- vector.compressstore %base[%i], %mask, %value</span><span>
</span><span id="line-187"></span><span class="hs-comment">--   : memref\&lt;?xf32&gt;, vector\&lt;8xi1&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- </span><span>
</span><span id="line-189"></span><span class="hs-comment">-- vector.compressstore %base[%i, %j], %mask, %value</span><span>
</span><span id="line-190"></span><span class="hs-comment">--   : memref\&lt;?x?xf32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt;</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-192"></span><span class="hs-comment">--   </span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | A builder for @vector.compressstore@.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679447967"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#compressstore"><span class="hs-identifier hs-type">compressstore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447967"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447967"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-196"></span><span id="compressstore"><span class="annot"><span class="annottext">compressstore :: Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; m ()
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#compressstore"><span class="hs-identifier hs-var hs-var">compressstore</span></a></span></span><span>  </span><span id="local-6989586621679447965"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447965"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447964"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447964"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447963"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447963"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447962"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447962"><span class="hs-identifier hs-var">valueToStore_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.compressstore&quot;</span></span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447965"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447964"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447963"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447962"><span class="hs-identifier hs-var">valueToStore_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- * constant_mask</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- $constant_mask</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- </span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Creates and returns a vector mask where elements of the result vector</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- are set to \'0\' or \'1\', based on whether the element indices are contained</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- within a hyper-rectangular region specified by the \'mask_dim_sizes\'</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- array attribute argument. Each element of the \'mask_dim_sizes\' array,</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- specifies an exclusive upper bound [0, mask-dim-size-element-value)</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- for a unique dimension in the vector result. The conjunction of the ranges</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- define a hyper-rectangular region within which elements values are set to 1</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- (otherwise element values are set to 0). Each value of \'mask_dim_sizes\' must</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- be non-negative and not greater than the size of the corresponding vector</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- dimension (as opposed to vector.create_mask which allows this).</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- </span><span>
</span><span id="line-221"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- </span><span>
</span><span id="line-223"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- // create a constant vector mask of size 4x3xi1 with elements in range</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- // 0 \&lt;= row \&lt;= 2 and 0 \&lt;= col \&lt;= 1 are set to 1 (others to 0).</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- %1 = vector.constant_mask [3, 2] : vector\&lt;4x3xi1&gt;</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- </span><span>
</span><span id="line-228"></span><span class="hs-comment">-- print %1</span><span>
</span><span id="line-229"></span><span class="hs-comment">--               columns</span><span>
</span><span id="line-230"></span><span class="hs-comment">--             0    1    2</span><span>
</span><span id="line-231"></span><span class="hs-comment">--           |------------</span><span>
</span><span id="line-232"></span><span class="hs-comment">--         0 | 1    1    0</span><span>
</span><span id="line-233"></span><span class="hs-comment">--   rows  1 | 1    1    0</span><span>
</span><span id="line-234"></span><span class="hs-comment">--         2 | 1    1    0</span><span>
</span><span id="line-235"></span><span class="hs-comment">--         3 | 0    0    0</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-237"></span><span class="hs-comment">--   </span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalConstantMaskOpAttributes"><span class="hs-identifier hs-type">InternalConstantMaskOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-240"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalConstantMaskOpAttributes"><span id="%24mInternalConstantMaskOpAttributes"><span id="InternalConstantMaskOpAttributes"><span class="annot"><span class="annottext">$bInternalConstantMaskOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalConstantMaskOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalConstantMaskOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalConstantMaskOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447956"><span class="hs-identifier hs-type">mask_dim_sizes_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447955"><span class="annot"><a href="#local-6989586621679447955"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;mask_dim_sizes&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447955"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447956"><span class="annot"><a href="#local-6989586621679447956"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalConstantMaskOpAttributes"><span class="hs-identifier hs-var">InternalConstantMaskOpAttributes</span></a></span><span> </span><span id="local-6989586621679447952"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447952"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mask_dim_sizes&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447952"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | A pattern for @vector.constant_mask@.</span><span>
</span><span id="line-244"></span><span id="local-6989586621679448126"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#ConstantMask"><span class="hs-identifier hs-type">ConstantMask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448126"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-245"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bConstantMask"><span id="%24mConstantMask"><span id="ConstantMask"><span class="annot"><span class="annottext">$bConstantMask :: Location -&gt; Type -&gt; [Int] -&gt; AbstractOperation operand
$mConstantMask :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; [Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bConstantMask"><span class="hs-identifier hs-var hs-var hs-var">ConstantMask</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447947"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447946"><span class="hs-identifier hs-type">ty0</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679447945"><span class="hs-identifier hs-type">mask_dim_sizes_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-246"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.constant_mask&quot;</span></span><span>
</span><span id="line-247"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447947"><span class="annot"><a href="#local-6989586621679447947"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-248"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447946"><span class="annot"><a href="#local-6989586621679447946"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalConstantMaskOpAttributes"><span class="hs-identifier hs-type">InternalConstantMaskOpAttributes</span></a></span><span> </span><span id="local-6989586621679447945"><span class="annot"><a href="#local-6989586621679447945"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | A builder for @vector.constant_mask@.</span><span>
</span><span id="line-256"></span><span id="local-6989586621679447944"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#constant_mask"><span class="hs-identifier hs-type">constant_mask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-257"></span><span id="constant_mask"><span class="annot"><span class="annottext">constant_mask :: Type -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#constant_mask"><span class="hs-identifier hs-var hs-var">constant_mask</span></a></span></span><span> </span><span id="local-6989586621679447942"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447942"><span class="hs-identifier hs-var">ty0</span></a></span></span><span>  </span><span id="local-6989586621679447941"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447941"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-259"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.constant_mask&quot;</span></span><span>
</span><span id="line-260"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447942"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalConstantMaskOpAttributes"><span class="hs-identifier hs-var">InternalConstantMaskOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447941"><span class="hs-identifier hs-var">mask_dim_sizes_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- * contract</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- $contract</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- </span><span>
</span><span id="line-271"></span><span class="hs-comment">-- Computes the sum of products of vector elements along contracting</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- dimension pairs from 2 vectors of rank M and N respectively, adds this</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- intermediate result to the accumulator argument of rank K, and returns a</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- vector result of rank K (where K = num_lhs_free_dims + num_rhs_free_dims +</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- num_batch_dims (see dimension type descriptions below)). For K = 0 (no</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- free or batch dimensions), the accumulator and output are a scalar.</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- </span><span>
</span><span id="line-278"></span><span class="hs-comment">-- Optional vector mask arguments (produced by CreateMaskOp or ConstantMaskOp)</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- specify the dynamic dimension sizes of valid data within the lhs/rhs vector</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- arguments.</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- </span><span>
</span><span id="line-282"></span><span class="hs-comment">-- An iterator type attribute list must be specified, where each element of</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- the list represents an iterator with one of the following types:</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- </span><span>
</span><span id="line-285"></span><span class="hs-comment">-- *) \&quot;reduction\&quot;: reduction dimensions are present in the lhs and rhs</span><span>
</span><span id="line-286"></span><span class="hs-comment">--                 arguments but not in the output (and accumulator</span><span>
</span><span id="line-287"></span><span class="hs-comment">--                 argument). These are the dimensions along which the vector</span><span>
</span><span id="line-288"></span><span class="hs-comment">--                 contraction op computes the sum of products, and</span><span>
</span><span id="line-289"></span><span class="hs-comment">--                 contracting dimension pair dimension sizes must match</span><span>
</span><span id="line-290"></span><span class="hs-comment">--                 between lhs/rhs.</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- *) \&quot;parallel\&quot;: Batch dimensions are iterator type \&quot;parallel\&quot;, and</span><span>
</span><span id="line-292"></span><span class="hs-comment">--                are non-contracting dimensions present in the lhs, rhs and</span><span>
</span><span id="line-293"></span><span class="hs-comment">--                output. The lhs/rhs co-iterate along the batch dimensions,</span><span>
</span><span id="line-294"></span><span class="hs-comment">--                which should be expressed in their indexing maps.</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- </span><span>
</span><span id="line-296"></span><span class="hs-comment">--                Free dimensions are iterator type \&quot;parallel\&quot;, and are</span><span>
</span><span id="line-297"></span><span class="hs-comment">--                non-contraction, non-batch dimensions accessed by either the</span><span>
</span><span id="line-298"></span><span class="hs-comment">--                lhs or rhs (but not both). The lhs and rhs free dimensions</span><span>
</span><span id="line-299"></span><span class="hs-comment">--                are unrelated to each other and do not co-iterate, which</span><span>
</span><span id="line-300"></span><span class="hs-comment">--                should be expressed in their indexing maps.</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- </span><span>
</span><span id="line-302"></span><span class="hs-comment">-- An indexing map attribute list must be specified with an entry for lhs, rhs</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- and acc arguments. An indexing map attribute specifies a mapping from each</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- iterator in the iterator type list, to each dimension of an N-D vector.</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- </span><span>
</span><span id="line-306"></span><span class="hs-comment">-- An optional kind attribute may be used to specify the combining function</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- between the intermediate result and accumulator argument of rank K. This</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- attribute can take the values add/mul/min/max for int/fp, and/or/xor for</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- int only. The default is \&quot;add\&quot;.</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- </span><span>
</span><span id="line-311"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- </span><span>
</span><span id="line-313"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- // Simple DOT product (K = 0).</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- \#contraction_accesses = [</span><span>
</span><span id="line-316"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; (i)&gt;,</span><span>
</span><span id="line-317"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; (i)&gt;,</span><span>
</span><span id="line-318"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; ()&gt;</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- \#contraction_trait = {</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   indexing_maps = \#contraction_accesses,</span><span>
</span><span id="line-322"></span><span class="hs-comment">--   iterator_types = [\&quot;reduction\&quot;]</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- %3 = vector.contract \#contraction_trait %0, %1, %2</span><span>
</span><span id="line-325"></span><span class="hs-comment">--   : vector\&lt;10xf32&gt;, vector\&lt;10xf32&gt; into f32</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- </span><span>
</span><span id="line-327"></span><span class="hs-comment">-- // 2D vector contraction with one contracting dimension (matmul, K = 2).</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- \#contraction_accesses = [</span><span>
</span><span id="line-329"></span><span class="hs-comment">--   affine_map\&lt;(i, j, k) -&gt; (i, k)&gt;,</span><span>
</span><span id="line-330"></span><span class="hs-comment">--   affine_map\&lt;(i, j, k) -&gt; (k, j)&gt;,</span><span>
</span><span id="line-331"></span><span class="hs-comment">--   affine_map\&lt;(i, j, k) -&gt; (i, j)&gt;</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- \#contraction_trait = {</span><span>
</span><span id="line-334"></span><span class="hs-comment">--   indexing_maps = \#contraction_accesses,</span><span>
</span><span id="line-335"></span><span class="hs-comment">--   iterator_types = [\&quot;parallel\&quot;, \&quot;parallel\&quot;, \&quot;reduction\&quot;]</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- </span><span>
</span><span id="line-338"></span><span class="hs-comment">-- %3 = vector.contract \#contraction_trait %0, %1, %2</span><span>
</span><span id="line-339"></span><span class="hs-comment">--   : vector\&lt;4x3xf32&gt;, vector\&lt;3x7xf32&gt; into vector\&lt;4x7xf32&gt;</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- </span><span>
</span><span id="line-341"></span><span class="hs-comment">-- // 4D to 3D vector contraction with two contracting dimensions and</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- // one batch dimension (K = 3).</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- \#contraction_accesses = [</span><span>
</span><span id="line-344"></span><span class="hs-comment">--   affine_map\&lt;(b0, f0, f1, c0, c1) -&gt; (c0, b0, c1, f0)&gt;,</span><span>
</span><span id="line-345"></span><span class="hs-comment">--   affine_map\&lt;(b0, f0, f1, c0, c1) -&gt; (b0, c1, c0, f1)&gt;,</span><span>
</span><span id="line-346"></span><span class="hs-comment">--   affine_map\&lt;(b0, f0, f1, c0, c1) -&gt; (b0, f0, f1)&gt;</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- \#contraction_trait = {</span><span>
</span><span id="line-349"></span><span class="hs-comment">--   indexing_maps = \#contraction_accesses,</span><span>
</span><span id="line-350"></span><span class="hs-comment">--   iterator_types = [\&quot;parallel\&quot;, \&quot;parallel\&quot;, \&quot;parallel\&quot;,</span><span>
</span><span id="line-351"></span><span class="hs-comment">--                     \&quot;reduction\&quot;, \&quot;reduction\&quot;]</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- </span><span>
</span><span id="line-354"></span><span class="hs-comment">-- %4 = vector.contract \#contraction_trait %0, %1, %2</span><span>
</span><span id="line-355"></span><span class="hs-comment">--     : vector\&lt;7x8x16x15xf32&gt;, vector\&lt;8x16x7x5xf32&gt; into vector\&lt;8x15x5xf32&gt;</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- </span><span>
</span><span id="line-357"></span><span class="hs-comment">-- // 4D vector contraction with two contracting dimensions and optional</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- // vector mask arguments.</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- %lhs_mask = vector.constant_mask [7, 8, 16, 15] : vector\&lt;7x8x16x15xi1&gt;</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- %rhs_mask = vector.constant_mask [8, 16, 7, 5] : vector\&lt;8x16x7x5xi1&gt;</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- </span><span>
</span><span id="line-362"></span><span class="hs-comment">-- %5 = vector.contract \#contraction_trait %0, %1, %2, %lhs_mask, %rhs_mask</span><span>
</span><span id="line-363"></span><span class="hs-comment">--    : vector\&lt;7x8x16x15xf32&gt;, vector\&lt;8x16x7x5xf32&gt; into vector\&lt;8x15x8x5xf32&gt;</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- </span><span>
</span><span id="line-365"></span><span class="hs-comment">-- // Vector contraction with mixed typed. lhs/rhs have different element</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- // types than accumulator/result.</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- %6 = vector.contract \#contraction_trait %0, %1, %2</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   : vector\&lt;10xf16&gt;, vector\&lt;10xf16&gt; into f32</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- </span><span>
</span><span id="line-370"></span><span class="hs-comment">-- // Contract with max (K = 0).</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- \#contraction_accesses = [</span><span>
</span><span id="line-372"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; (i)&gt;,</span><span>
</span><span id="line-373"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; (i)&gt;,</span><span>
</span><span id="line-374"></span><span class="hs-comment">--  affine_map\&lt;(i) -&gt; ()&gt;</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- \#contraction_trait = {</span><span>
</span><span id="line-377"></span><span class="hs-comment">--   indexing_maps = \#contraction_accesses,</span><span>
</span><span id="line-378"></span><span class="hs-comment">--   iterator_types = [\&quot;reduction\&quot;],</span><span>
</span><span id="line-379"></span><span class="hs-comment">--   kind = \#vector.kind\&lt;max&gt;</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- %7 = vector.contract \#contraction_trait %0, %1, %2</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   : vector\&lt;10xf32&gt;, vector\&lt;10xf32&gt; into f32</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-384"></span><span class="hs-comment">--   </span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalContractionOpAttributes"><span class="hs-identifier hs-type">InternalContractionOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-387"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalContractionOpAttributes"><span id="%24mInternalContractionOpAttributes"><span id="InternalContractionOpAttributes"><span class="annot"><span class="annottext">$bInternalContractionOpAttributes :: [Attribute] -&gt; [Attribute] -&gt; Map Name Attribute
$mInternalContractionOpAttributes :: forall r.
Map Name Attribute
-&gt; ([Attribute] -&gt; [Attribute] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalContractionOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalContractionOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447937"><span class="hs-identifier hs-type">indexing_maps_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447936"><span class="hs-identifier hs-type">iterator_types_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447935"><span class="annot"><a href="#local-6989586621679447935"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;indexing_maps&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447935"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;iterator_types&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447935"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#ArrayAttr"><span class="hs-identifier hs-type">ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447937"><span class="annot"><a href="#local-6989586621679447937"><span class="hs-identifier hs-var">indexing_maps_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#ArrayAttr"><span class="hs-identifier hs-type">ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447936"><span class="annot"><a href="#local-6989586621679447936"><span class="hs-identifier hs-var">iterator_types_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalContractionOpAttributes"><span class="hs-identifier hs-var">InternalContractionOpAttributes</span></a></span><span> </span><span id="local-6989586621679447933"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447933"><span class="hs-identifier hs-var">indexing_maps_</span></a></span></span><span> </span><span id="local-6989586621679447932"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447932"><span class="hs-identifier hs-var">iterator_types_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;indexing_maps&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Attribute
</span><a href="MLIR.AST.html#ArrayAttr"><span class="hs-identifier hs-var">ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447933"><span class="hs-identifier hs-var">indexing_maps_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;iterator_types&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Attribute
</span><a href="MLIR.AST.html#ArrayAttr"><span class="hs-identifier hs-var">ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447932"><span class="hs-identifier hs-var">iterator_types_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | A builder for @vector.contract@.</span><span>
</span><span id="line-391"></span><span id="local-6989586621679447931"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#contract"><span class="hs-identifier hs-type">contract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447931"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447931"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-392"></span><span id="contract"><span class="annot"><span class="annottext">contract :: Type
-&gt; Value
-&gt; Value
-&gt; Value
-&gt; [Value]
-&gt; [Attribute]
-&gt; [Attribute]
-&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#contract"><span class="hs-identifier hs-var hs-var">contract</span></a></span></span><span> </span><span id="local-6989586621679447929"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447929"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447928"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447928"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span> </span><span id="local-6989586621679447927"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447927"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span> </span><span id="local-6989586621679447926"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447926"><span class="hs-identifier hs-var">acc_</span></a></span></span><span> </span><span id="local-6989586621679447925"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447925"><span class="hs-identifier hs-var">masks_</span></a></span></span><span> </span><span id="local-6989586621679447924"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447924"><span class="hs-identifier hs-var">indexing_maps_</span></a></span></span><span> </span><span id="local-6989586621679447923"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447923"><span class="hs-identifier hs-var">iterator_types_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-394"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.contract&quot;</span></span><span>
</span><span id="line-395"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-396"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447929"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447928"><span class="hs-identifier hs-var">lhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447927"><span class="hs-identifier hs-var">rhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447926"><span class="hs-identifier hs-var">acc_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447925"><span class="hs-identifier hs-var">masks_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-399"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalContractionOpAttributes"><span class="hs-identifier hs-var">InternalContractionOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447924"><span class="hs-identifier hs-var">indexing_maps_</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679447923"><span class="hs-identifier hs-var">iterator_types_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- * create_mask</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- $create_mask</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- </span><span>
</span><span id="line-406"></span><span class="hs-comment">-- Creates and returns a vector mask where elements of the result vector</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- are set to \'0\' or \'1\', based on whether the element indices are contained</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- within a hyper-rectangular region specified by the operands. Specifically,</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- each operand specifies a range [0, operand-value) for a unique dimension in</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- the vector result. The conjunction of the operand ranges define a</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- hyper-rectangular region within which elements values are set to 1</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- (otherwise element values are set to 0). If operand-value is negative, it is</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- treated as if it were zero, and if it is greater than the corresponding</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- dimension size, it is treated as if it were equal to the dimension size.</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- </span><span>
</span><span id="line-416"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- </span><span>
</span><span id="line-418"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- // create a vector mask of size 4x3xi1 where elements in range</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- // 0 \&lt;= row \&lt;= 2 and 0 \&lt;= col \&lt;= 1 are set to 1 (others to 0).</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- %1 = vector.create_mask %c3, %c2 : vector\&lt;4x3xi1&gt;</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- </span><span>
</span><span id="line-423"></span><span class="hs-comment">-- print %1</span><span>
</span><span id="line-424"></span><span class="hs-comment">--               columns</span><span>
</span><span id="line-425"></span><span class="hs-comment">--             0    1    2</span><span>
</span><span id="line-426"></span><span class="hs-comment">--           |------------</span><span>
</span><span id="line-427"></span><span class="hs-comment">--         0 | 1    1    0</span><span>
</span><span id="line-428"></span><span class="hs-comment">--   rows  1 | 1    1    0</span><span>
</span><span id="line-429"></span><span class="hs-comment">--         2 | 1    1    0</span><span>
</span><span id="line-430"></span><span class="hs-comment">--         3 | 0    0    0</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-432"></span><span class="hs-comment">--   </span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- | A pattern for @vector.create_mask@.</span><span>
</span><span id="line-435"></span><span id="local-6989586621679448118"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#CreateMask"><span class="hs-identifier hs-type">CreateMask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679448118"><span class="hs-identifier hs-type">operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448118"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-436"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bCreateMask"><span id="%24mCreateMask"><span id="CreateMask"><span class="annot"><span class="annottext">$bCreateMask :: Location -&gt; Type -&gt; [operand] -&gt; AbstractOperation operand
$mCreateMask :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; [operand] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bCreateMask"><span class="hs-identifier hs-var hs-var hs-var">CreateMask</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447919"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447918"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447917"><span class="hs-identifier hs-type">operands_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-437"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.create_mask&quot;</span></span><span>
</span><span id="line-438"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447919"><span class="annot"><a href="#local-6989586621679447919"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-439"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447918"><span class="annot"><a href="#local-6989586621679447918"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447917"><span class="annot"><a href="#local-6989586621679447917"><span class="hs-identifier hs-var">operands_</span></a></span></span><span>
</span><span id="line-441"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | A builder for @vector.create_mask@.</span><span>
</span><span id="line-447"></span><span id="local-6989586621679447916"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#create_mask"><span class="hs-identifier hs-type">create_mask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447916"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447916"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-448"></span><span id="create_mask"><span class="annot"><span class="annottext">create_mask :: Type -&gt; [Value] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#create_mask"><span class="hs-identifier hs-var hs-var">create_mask</span></a></span></span><span> </span><span id="local-6989586621679447914"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447914"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447913"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447913"><span class="hs-identifier hs-var">operands_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-450"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.create_mask&quot;</span></span><span>
</span><span id="line-451"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-452"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447914"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447913"><span class="hs-identifier hs-var">operands_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- * expandload</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- $expandload</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- </span><span>
</span><span id="line-462"></span><span class="hs-comment">-- The expand load reads elements from memory into a 1-D vector as defined</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- by a base with indices and a 1-D mask vector. When the mask is set, the</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- next element is read from memory. Otherwise, the corresponding element</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- is taken from a 1-D pass-through vector. Informally the semantics are:</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- index = i</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- result[0] := mask[0] ? base[index++] : pass_thru[0]</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- result[1] := mask[1] ? base[index++] : pass_thru[1]</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- Note that the index increment is done conditionally.</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- </span><span>
</span><span id="line-474"></span><span class="hs-comment">-- The expand load can be used directly where applicable, or can be used</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- hardware ISA support for an expand. The semantics of the operation closely</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- correspond to those of the @llvm.masked.expandload@</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- intrinsic.</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- </span><span>
</span><span id="line-480"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- </span><span>
</span><span id="line-482"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- %0 = vector.expandload %base[%i], %mask, %pass_thru</span><span>
</span><span id="line-484"></span><span class="hs-comment">--    : memref\&lt;?xf32&gt;, vector\&lt;8xi1&gt;, vector\&lt;8xf32&gt; into vector\&lt;8xf32&gt;</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- </span><span>
</span><span id="line-486"></span><span class="hs-comment">-- %1 = vector.expandload %base[%i, %j], %mask, %pass_thru</span><span>
</span><span id="line-487"></span><span class="hs-comment">--    : memref\&lt;?x?xf32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt; into vector\&lt;16xf32&gt;</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-489"></span><span class="hs-comment">--   </span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- | A builder for @vector.expandload@.</span><span>
</span><span id="line-492"></span><span id="local-6989586621679447912"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#expandload"><span class="hs-identifier hs-type">expandload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-493"></span><span id="expandload"><span class="annot"><span class="annottext">expandload :: Type -&gt; Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#expandload"><span class="hs-identifier hs-var hs-var">expandload</span></a></span></span><span> </span><span id="local-6989586621679447910"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447910"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447909"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447909"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447908"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447908"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447907"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447907"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447906"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447906"><span class="hs-identifier hs-var">pass_thru_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-495"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.expandload&quot;</span></span><span>
</span><span id="line-496"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-497"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447910"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447909"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447908"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447907"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447906"><span class="hs-identifier hs-var">pass_thru_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-501"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- * extractelement</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- $extractelement</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- </span><span>
</span><span id="line-507"></span><span class="hs-comment">-- Takes a 0-D or 1-D vector and a optional dynamic index position and</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- extracts the scalar at that position.</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- </span><span>
</span><span id="line-510"></span><span class="hs-comment">-- Note that this instruction resembles vector.extract, but is restricted to</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- 0-D and 1-D vectors and relaxed to dynamic indices.</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- If the vector is 0-D, the position must be llvm::None.</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- </span><span>
</span><span id="line-514"></span><span class="hs-comment">-- </span><span>
</span><span id="line-515"></span><span class="hs-comment">-- It is meant to be closer to LLVM\'s version:</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- https://llvm.org/docs/LangRef.html\#extractelement-instruction</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- </span><span>
</span><span id="line-518"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- </span><span>
</span><span id="line-520"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- %c = arith.constant 15 : i32</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- %1 = vector.extractelement %0[%c : i32]: vector\&lt;16xf32&gt;</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- %2 = vector.extractelement %z[]: vector\&lt;f32&gt;</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-525"></span><span class="hs-comment">--   </span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | A builder for @vector.extractelement@.</span><span>
</span><span id="line-528"></span><span id="local-6989586621679447905"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#extractelement"><span class="hs-identifier hs-type">extractelement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447905"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447905"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-529"></span><span id="extractelement"><span class="annot"><span class="annottext">extractelement :: Type -&gt; Value -&gt; Maybe Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#extractelement"><span class="hs-identifier hs-var hs-var">extractelement</span></a></span></span><span> </span><span id="local-6989586621679447903"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447903"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447902"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447902"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447901"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447901"><span class="hs-identifier hs-var">position_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-531"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.extractelement&quot;</span></span><span>
</span><span id="line-532"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-533"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447903"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-534"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447902"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; [Name]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">Data.Maybe.maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447901"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-537"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">-- * extract_map</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- $extract_map</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- </span><span>
</span><span id="line-543"></span><span class="hs-comment">-- Takes an N-D vector and extracts a sub-part of the vector starting at id</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- along each dimension.</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- </span><span>
</span><span id="line-546"></span><span class="hs-comment">-- The dimension associated to each element of @ids@ used to extract are</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- implicitly deduced from the destination type. For each dimension the</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- multiplicity is the destination dimension size divided by the source</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- dimension size, each dimension with a multiplicity greater than 1 is</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- associated to the next id, following ids order.</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- For example if the source type is @vector\&lt;64x4x32xf32&gt;@ and the destination</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- type is @vector\&lt;4x4x2xf32&gt;@, the first id maps to dimension 0 and the second</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- id to dimension 2.</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- </span><span>
</span><span id="line-555"></span><span class="hs-comment">-- Similarly to vector.tuple_get, this operation is used for progressive</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- lowering and should be folded away before converting to LLVM.</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- </span><span>
</span><span id="line-558"></span><span class="hs-comment">-- It is different than @vector.extract_slice@ and</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- @vector.extract_strided_slice@ as it takes a Value as index instead of an</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- attribute. Also in the future it is meant to support extracting along any</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- dimensions and not only the most major ones.</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- </span><span>
</span><span id="line-563"></span><span class="hs-comment">-- For instance:</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- // dynamic computation producing the value 0 of index type</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- %idx0 = ... : index</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- // dynamic computation producing the value 1 of index type</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- %idx1 = ... : index</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- %0 = arith.constant dense\&lt;0, 1, 2, 3&gt;: vector\&lt;4xi32&gt;</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- // extracts values [0, 1]</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- %1 = vector.extract_map %0[%idx0] : vector\&lt;4xi32&gt; to vector\&lt;2xi32&gt;</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- // extracts values [1, 2]</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- %2 = vector.extract_map %0[%idx1] : vector\&lt;4xi32&gt; to vector\&lt;2xi32&gt;</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- </span><span>
</span><span id="line-576"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- </span><span>
</span><span id="line-578"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- %ev = vector.extract_map %v[%id] : vector\&lt;32xf32&gt; to vector\&lt;1xf32&gt;</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- %ev1 = vector.extract_map %v1[%id1, %id2] : vector\&lt;64x4x32xf32&gt;</span><span>
</span><span id="line-581"></span><span class="hs-comment">--   to vector\&lt;4x4x2xf32&gt;</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-583"></span><span class="hs-comment">--   </span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- | A builder for @vector.extract_map@.</span><span>
</span><span id="line-586"></span><span id="local-6989586621679447899"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#extract_map"><span class="hs-identifier hs-type">extract_map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447899"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447899"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-587"></span><span id="extract_map"><span class="annot"><span class="annottext">extract_map :: Type -&gt; Value -&gt; [Value] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#extract_map"><span class="hs-identifier hs-var hs-var">extract_map</span></a></span></span><span> </span><span id="local-6989586621679447897"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447897"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447896"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447896"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447895"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447895"><span class="hs-identifier hs-var">ids_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-589"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.extract_map&quot;</span></span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-591"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447897"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447896"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447895"><span class="hs-identifier hs-var">ids_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">-- * extract</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- $extract</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- </span><span>
</span><span id="line-601"></span><span class="hs-comment">-- Takes an n-D vector and a k-D position and extracts the (n-k)-D vector at</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- the proper position. Degenerates to an element type in the 0-D case.</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- </span><span>
</span><span id="line-604"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- </span><span>
</span><span id="line-606"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- %1 = vector.extract %0[3]: vector\&lt;4x8x16xf32&gt;</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- %2 = vector.extract %0[3, 3, 3]: vector\&lt;4x8x16xf32&gt;</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-610"></span><span class="hs-comment">--   </span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractOpAttributes"><span class="hs-identifier hs-type">InternalExtractOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-613"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalExtractOpAttributes"><span id="%24mInternalExtractOpAttributes"><span id="InternalExtractOpAttributes"><span class="annot"><span class="annottext">$bInternalExtractOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalExtractOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalExtractOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalExtractOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447891"><span class="hs-identifier hs-type">position_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447890"><span class="annot"><a href="#local-6989586621679447890"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;position&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447890"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447891"><span class="annot"><a href="#local-6989586621679447891"><span class="hs-identifier hs-var">position_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractOpAttributes"><span class="hs-identifier hs-var">InternalExtractOpAttributes</span></a></span><span> </span><span id="local-6989586621679447889"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447889"><span class="hs-identifier hs-var">position_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;position&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447889"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="hs-comment">-- | A pattern for @vector.extract@.</span><span>
</span><span id="line-617"></span><span id="local-6989586621679448106"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448106"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448106"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-618"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bExtract"><span id="%24mExtract"><span id="Extract"><span class="annot"><span class="annottext">$bExtract :: Location -&gt; Type -&gt; operand -&gt; [Int] -&gt; AbstractOperation operand
$mExtract :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; [Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bExtract"><span class="hs-identifier hs-var hs-var hs-var">Extract</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447885"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447884"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447883"><span class="hs-identifier hs-type">vector_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447882"><span class="hs-identifier hs-type">position_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-619"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.extract&quot;</span></span><span>
</span><span id="line-620"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447885"><span class="annot"><a href="#local-6989586621679447885"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-621"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447884"><span class="annot"><a href="#local-6989586621679447884"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447883"><span class="annot"><a href="#local-6989586621679447883"><span class="hs-identifier hs-var">vector_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-623"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-625"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractOpAttributes"><span class="hs-identifier hs-type">InternalExtractOpAttributes</span></a></span><span> </span><span id="local-6989586621679447882"><span class="annot"><a href="#local-6989586621679447882"><span class="hs-identifier hs-var">position_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | A builder for @vector.extract@.</span><span>
</span><span id="line-629"></span><span id="local-6989586621679447881"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#extract"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447881"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447881"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-630"></span><span id="extract"><span class="annot"><span class="annottext">extract :: Type -&gt; Value -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span id="local-6989586621679447879"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447879"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447878"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447878"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447877"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447877"><span class="hs-identifier hs-var">position_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-632"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.extract&quot;</span></span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-634"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447879"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447878"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-636"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractOpAttributes"><span class="hs-identifier hs-var">InternalExtractOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447877"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- * extract_strided_slice</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- $extract_strided_slice</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- </span><span>
</span><span id="line-644"></span><span class="hs-comment">-- Takes an n-D vector, k-D @offsets@ integer array attribute, a k-sized</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- @sizes@ integer array attribute, a k-sized @strides@ integer array</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- attribute and extracts the n-D subvector at the proper offset.</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- </span><span>
</span><span id="line-648"></span><span class="hs-comment">-- At the moment strides must contain only 1s.</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- // TODO: support non-1 strides.</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- </span><span>
</span><span id="line-651"></span><span class="hs-comment">-- Returns an n-D vector where the first k-D dimensions match the @sizes@</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- attribute. The returned subvector contains the elements starting at offset</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- @offsets@ and ending at @offsets + sizes@.</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- </span><span>
</span><span id="line-655"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- </span><span>
</span><span id="line-657"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- %1 = vector.extract_strided_slice %0</span><span>
</span><span id="line-659"></span><span class="hs-comment">--     {offsets = [0, 2], sizes = [2, 4], strides = [1, 1]}:</span><span>
</span><span id="line-660"></span><span class="hs-comment">--   vector\&lt;4x8x16xf32&gt; to vector\&lt;2x4x16xf32&gt;</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- </span><span>
</span><span id="line-662"></span><span class="hs-comment">-- // TODO: Evolve to a range form syntax similar to:</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- %1 = vector.extract_strided_slice %0[0:2:1][2:4:1]</span><span>
</span><span id="line-664"></span><span class="hs-comment">--   vector\&lt;4x8x16xf32&gt; to vector\&lt;2x4x16xf32&gt;</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-666"></span><span class="hs-comment">--   </span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractStridedSliceOpAttributes"><span class="hs-identifier hs-type">InternalExtractStridedSliceOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-669"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalExtractStridedSliceOpAttributes"><span id="%24mInternalExtractStridedSliceOpAttributes"><span id="InternalExtractStridedSliceOpAttributes"><span class="annot"><span class="annottext">$bInternalExtractStridedSliceOpAttributes :: [Int] -&gt; [Int] -&gt; [Int] -&gt; Map Name Attribute
$mInternalExtractStridedSliceOpAttributes :: forall r.
Map Name Attribute
-&gt; ([Int] -&gt; [Int] -&gt; [Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalExtractStridedSliceOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalExtractStridedSliceOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447873"><span class="hs-identifier hs-type">offsets_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447872"><span class="hs-identifier hs-type">sizes_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447871"><span class="hs-identifier hs-type">strides_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447870"><span class="annot"><a href="#local-6989586621679447870"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;offsets&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;sizes&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;strides&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447873"><span class="annot"><a href="#local-6989586621679447873"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447872"><span class="annot"><a href="#local-6989586621679447872"><span class="hs-identifier hs-var">sizes_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447871"><span class="annot"><a href="#local-6989586621679447871"><span class="hs-identifier hs-var">strides_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractStridedSliceOpAttributes"><span class="hs-identifier hs-var">InternalExtractStridedSliceOpAttributes</span></a></span><span> </span><span id="local-6989586621679447869"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447869"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447868"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447868"><span class="hs-identifier hs-var">sizes_</span></a></span></span><span> </span><span id="local-6989586621679447867"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447867"><span class="hs-identifier hs-var">strides_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;offsets&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447869"><span class="hs-identifier hs-var">offsets_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;sizes&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447868"><span class="hs-identifier hs-var">sizes_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;strides&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447867"><span class="hs-identifier hs-var">strides_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-comment">-- | A pattern for @vector.extract_strided_slice@.</span><span>
</span><span id="line-673"></span><span id="local-6989586621679448099"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#ExtractStridedSlice"><span class="hs-identifier hs-type">ExtractStridedSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448099"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448099"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-674"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bExtractStridedSlice"><span id="%24mExtractStridedSlice"><span id="ExtractStridedSlice"><span class="annot"><span class="annottext">$bExtractStridedSlice :: Location
-&gt; Type
-&gt; operand
-&gt; [Int]
-&gt; [Int]
-&gt; [Int]
-&gt; AbstractOperation operand
$mExtractStridedSlice :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; [Int] -&gt; [Int] -&gt; [Int] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bExtractStridedSlice"><span class="hs-identifier hs-var hs-var hs-var">ExtractStridedSlice</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447863"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447862"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447861"><span class="hs-identifier hs-type">vector_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447860"><span class="hs-identifier hs-type">offsets_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447859"><span class="hs-identifier hs-type">sizes_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447858"><span class="hs-identifier hs-type">strides_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.extract_strided_slice&quot;</span></span><span>
</span><span id="line-676"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447863"><span class="annot"><a href="#local-6989586621679447863"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447862"><span class="annot"><a href="#local-6989586621679447862"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-678"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447861"><span class="annot"><a href="#local-6989586621679447861"><span class="hs-identifier hs-var">vector_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-679"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-680"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractStridedSliceOpAttributes"><span class="hs-identifier hs-type">InternalExtractStridedSliceOpAttributes</span></a></span><span> </span><span id="local-6989586621679447860"><span class="annot"><a href="#local-6989586621679447860"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447859"><span class="annot"><a href="#local-6989586621679447859"><span class="hs-identifier hs-var">sizes_</span></a></span></span><span> </span><span id="local-6989586621679447858"><span class="annot"><a href="#local-6989586621679447858"><span class="hs-identifier hs-var">strides_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span class="hs-comment">-- | A builder for @vector.extract_strided_slice@.</span><span>
</span><span id="line-685"></span><span id="local-6989586621679447857"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#extract_strided_slice"><span class="hs-identifier hs-type">extract_strided_slice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-686"></span><span id="extract_strided_slice"><span class="annot"><span class="annottext">extract_strided_slice :: Type -&gt; Value -&gt; [Int] -&gt; [Int] -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#extract_strided_slice"><span class="hs-identifier hs-var hs-var">extract_strided_slice</span></a></span></span><span> </span><span id="local-6989586621679447855"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447855"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447854"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447854"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447853"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447853"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447852"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447852"><span class="hs-identifier hs-var">sizes_</span></a></span></span><span> </span><span id="local-6989586621679447851"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447851"><span class="hs-identifier hs-var">strides_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.extract_strided_slice&quot;</span></span><span>
</span><span id="line-689"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-690"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447855"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447854"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-693"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalExtractStridedSliceOpAttributes"><span class="hs-identifier hs-var">InternalExtractStridedSliceOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447853"><span class="hs-identifier hs-var">offsets_</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447852"><span class="hs-identifier hs-var">sizes_</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447851"><span class="hs-identifier hs-var">strides_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="hs-comment">-- * fma</span><span>
</span><span id="line-698"></span><span class="hs-comment">-- $fma</span><span>
</span><span id="line-699"></span><span class="hs-comment">-- </span><span>
</span><span id="line-700"></span><span class="hs-comment">-- Multiply-add expressions operate on n-D vectors and compute a fused</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- pointwise multiply-and-accumulate: @\$result = @\$lhs * \$rhs + \$acc@.</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- All operands and result have the same vector type. The semantics</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- of the operation correspond to those of the @llvm.fma@</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- intrinsic. In the</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- particular case of lowering to LLVM, this is guaranteed to lower</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- to the @llvm.fma.*@ intrinsic.</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- </span><span>
</span><span id="line-708"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- </span><span>
</span><span id="line-710"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- %3 = vector.fma %0, %1, %2: vector\&lt;8x16xf32&gt;</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-713"></span><span class="hs-comment">--   </span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">-- | A pattern for @vector.fma@.</span><span>
</span><span id="line-716"></span><span id="local-6989586621679448094"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#FMA"><span class="hs-identifier hs-type">FMA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448094"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448094"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448094"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448094"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-717"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bFMA"><span id="%24mFMA"><span id="FMA"><span class="annot"><span class="annottext">$bFMA :: Location
-&gt; Type
-&gt; operand
-&gt; operand
-&gt; operand
-&gt; AbstractOperation operand
$mFMA :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; operand -&gt; operand -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bFMA"><span class="hs-identifier hs-var hs-var hs-var">FMA</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447847"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447846"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447845"><span class="hs-identifier hs-type">lhs_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447844"><span class="hs-identifier hs-type">rhs_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447843"><span class="hs-identifier hs-type">acc_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-718"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.fma&quot;</span></span><span>
</span><span id="line-719"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447847"><span class="annot"><a href="#local-6989586621679447847"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-720"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447846"><span class="annot"><a href="#local-6989586621679447846"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-721"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447845"><span class="annot"><a href="#local-6989586621679447845"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447844"><span class="annot"><a href="#local-6989586621679447844"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447843"><span class="annot"><a href="#local-6989586621679447843"><span class="hs-identifier hs-var">acc_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-723"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-724"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span class="hs-comment">-- | A builder for @vector.fma@.</span><span>
</span><span id="line-728"></span><span id="local-6989586621679447842"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#fma"><span class="hs-identifier hs-type">fma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-729"></span><span id="fma"><span class="annot"><span class="annottext">fma :: Type -&gt; Value -&gt; Value -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#fma"><span class="hs-identifier hs-var hs-var">fma</span></a></span></span><span> </span><span id="local-6989586621679447840"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447840"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447839"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447839"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span> </span><span id="local-6989586621679447838"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447838"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span> </span><span id="local-6989586621679447837"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447837"><span class="hs-identifier hs-var">acc_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-730"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-731"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.fma&quot;</span></span><span>
</span><span id="line-732"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-733"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447840"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-734"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447839"><span class="hs-identifier hs-var">lhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447838"><span class="hs-identifier hs-var">rhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447837"><span class="hs-identifier hs-var">acc_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-735"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-736"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-737"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">-- * flat_transpose</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- $flat_transpose</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- </span><span>
</span><span id="line-743"></span><span class="hs-comment">-- This is the counterpart of llvm.matrix.transpose in MLIR. It serves</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- the purposes of more progressive lowering and localized type conversion.</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- Higher levels typically lower matrix tranpositions into \'vector.transpose\'</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- operations. Subsequent rewriting rule progressively lower these operations</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- into \'vector.flat_transpose\' operations to bring the operations closer</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- to the hardware ISA.</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- </span><span>
</span><span id="line-750"></span><span class="hs-comment">-- The &#8216;vector.flat_transpose&#8217; op treats the 1-D input @matrix@ as</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- a 2-D matrix with \&lt;rows&gt; rows and \&lt;columns&gt; columns, and returns the</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- transposed matrix in flattened form in \'res\'.</span><span>
</span><span id="line-753"></span><span class="hs-comment">-- </span><span>
</span><span id="line-754"></span><span class="hs-comment">-- Also see:</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- </span><span>
</span><span id="line-756"></span><span class="hs-comment">-- http://llvm.org/docs/LangRef.html\#llvm-matrix-transpose-intrinsic</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- </span><span>
</span><span id="line-758"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- </span><span>
</span><span id="line-760"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- %1 = vector.flat_transpose %0 { rows = 4: i32, columns = 4: i32 }</span><span>
</span><span id="line-762"></span><span class="hs-comment">--    : (vector\&lt;16xf32&gt;) -&gt; vector\&lt;16xf32&gt;</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-764"></span><span class="hs-comment">--   </span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalFlatTransposeOpAttributes"><span class="hs-identifier hs-type">InternalFlatTransposeOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-767"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalFlatTransposeOpAttributes"><span id="%24mInternalFlatTransposeOpAttributes"><span id="InternalFlatTransposeOpAttributes"><span class="annot"><span class="annottext">$bInternalFlatTransposeOpAttributes :: Int -&gt; Int -&gt; Map Name Attribute
$mInternalFlatTransposeOpAttributes :: forall r.
Map Name Attribute -&gt; (Int -&gt; Int -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalFlatTransposeOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalFlatTransposeOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447833"><span class="hs-identifier hs-type">rows_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447832"><span class="hs-identifier hs-type">columns_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447831"><span class="annot"><a href="#local-6989586621679447831"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rows&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;columns&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447833"><span class="annot"><a href="#local-6989586621679447833"><span class="hs-identifier hs-var">rows_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447832"><span class="annot"><a href="#local-6989586621679447832"><span class="hs-identifier hs-var">columns_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalFlatTransposeOpAttributes"><span class="hs-identifier hs-var">InternalFlatTransposeOpAttributes</span></a></span><span> </span><span id="local-6989586621679447827"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447827"><span class="hs-identifier hs-var">rows_</span></a></span></span><span> </span><span id="local-6989586621679447826"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447826"><span class="hs-identifier hs-var">columns_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;rows&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447827"><span class="hs-identifier hs-var">rows_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;columns&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447826"><span class="hs-identifier hs-var">columns_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="hs-comment">-- | A pattern for @vector.flat_transpose@.</span><span>
</span><span id="line-771"></span><span id="local-6989586621679448085"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#FlatTranspose"><span class="hs-identifier hs-type">FlatTranspose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448085"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448085"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-772"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bFlatTranspose"><span id="%24mFlatTranspose"><span id="FlatTranspose"><span class="annot"><span class="annottext">$bFlatTranspose :: Location
-&gt; Type -&gt; operand -&gt; Int -&gt; Int -&gt; AbstractOperation operand
$mFlatTranspose :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; Int -&gt; Int -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bFlatTranspose"><span class="hs-identifier hs-var hs-var hs-var">FlatTranspose</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447822"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447821"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447820"><span class="hs-identifier hs-type">matrix_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447819"><span class="hs-identifier hs-type">rows_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447818"><span class="hs-identifier hs-type">columns_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-773"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.flat_transpose&quot;</span></span><span>
</span><span id="line-774"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447822"><span class="annot"><a href="#local-6989586621679447822"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-775"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447821"><span class="annot"><a href="#local-6989586621679447821"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-776"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447820"><span class="annot"><a href="#local-6989586621679447820"><span class="hs-identifier hs-var">matrix_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-778"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-779"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalFlatTransposeOpAttributes"><span class="hs-identifier hs-type">InternalFlatTransposeOpAttributes</span></a></span><span> </span><span id="local-6989586621679447819"><span class="annot"><a href="#local-6989586621679447819"><span class="hs-identifier hs-var">rows_</span></a></span></span><span> </span><span id="local-6989586621679447818"><span class="annot"><a href="#local-6989586621679447818"><span class="hs-identifier hs-var">columns_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-comment">-- | A builder for @vector.flat_transpose@.</span><span>
</span><span id="line-783"></span><span id="local-6989586621679447817"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#flat_transpose"><span class="hs-identifier hs-type">flat_transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447817"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-784"></span><span id="flat_transpose"><span class="annot"><span class="annottext">flat_transpose :: Type -&gt; Value -&gt; Int -&gt; Int -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#flat_transpose"><span class="hs-identifier hs-var hs-var">flat_transpose</span></a></span></span><span> </span><span id="local-6989586621679447815"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447815"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447814"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447814"><span class="hs-identifier hs-var">matrix_</span></a></span></span><span> </span><span id="local-6989586621679447813"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447813"><span class="hs-identifier hs-var">rows_</span></a></span></span><span> </span><span id="local-6989586621679447812"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447812"><span class="hs-identifier hs-var">columns_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-785"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-786"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.flat_transpose&quot;</span></span><span>
</span><span id="line-787"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-788"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447815"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-789"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447814"><span class="hs-identifier hs-var">matrix_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-790"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-791"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-792"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalFlatTransposeOpAttributes"><span class="hs-identifier hs-var">InternalFlatTransposeOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447813"><span class="hs-identifier hs-var">rows_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447812"><span class="hs-identifier hs-var">columns_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- * gather</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- $gather</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- </span><span>
</span><span id="line-798"></span><span class="hs-comment">-- The gather operation gathers elements from memory or ranked tensor into a</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- n-D vector as defined by a base with indices and an additional n-D index</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- vector (each index is a 1-D offset on the base), but only if the</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- corresponding bit is set in a n-D mask vector. Otherwise, the element is</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- taken from a n-D pass-through vector. Informally the semantics are:</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- result[0] := mask[0] ? base[index[0]] : pass_thru[0]</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- result[1] := mask[1] ? base[index[1]] : pass_thru[1]</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-808"></span><span class="hs-comment">-- The vector dialect leaves out-of-bounds behavior undefined.</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- </span><span>
</span><span id="line-810"></span><span class="hs-comment">-- The gather operation can be used directly where applicable, or can be used</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- hardware ISA support for a gather.</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- </span><span>
</span><span id="line-814"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- </span><span>
</span><span id="line-816"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-817"></span><span class="hs-comment">-- %0 = vector.gather %base[%c0][%v], %mask, %pass_thru</span><span>
</span><span id="line-818"></span><span class="hs-comment">--    : memref\&lt;?xf32&gt;, vector\&lt;2x16xi32&gt;, vector\&lt;2x16xi1&gt;, vector\&lt;2x16xf32&gt; into vector\&lt;2x16xf32&gt;</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- </span><span>
</span><span id="line-820"></span><span class="hs-comment">-- %1 = vector.gather %base[%i, %j][%v], %mask, %pass_thru</span><span>
</span><span id="line-821"></span><span class="hs-comment">--    : memref\&lt;16x16xf32&gt;, vector\&lt;16xi32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt; into vector\&lt;16xf32&gt;</span><span>
</span><span id="line-822"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-823"></span><span class="hs-comment">--   </span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-comment">-- | A builder for @vector.gather@.</span><span>
</span><span id="line-826"></span><span id="local-6989586621679447811"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#gather"><span class="hs-identifier hs-type">gather</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447811"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447811"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-827"></span><span id="gather"><span class="annot"><span class="annottext">gather :: Type -&gt; Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#gather"><span class="hs-identifier hs-var hs-var">gather</span></a></span></span><span> </span><span id="local-6989586621679447809"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447809"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447808"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447808"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447807"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447807"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447806"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447806"><span class="hs-identifier hs-var">index_vec_</span></a></span></span><span> </span><span id="local-6989586621679447805"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447805"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447804"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447804"><span class="hs-identifier hs-var">pass_thru_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-828"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-829"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.gather&quot;</span></span><span>
</span><span id="line-830"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-831"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447809"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447808"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447807"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447806"><span class="hs-identifier hs-var">index_vec_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447805"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447804"><span class="hs-identifier hs-var">pass_thru_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-834"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-835"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span class="hs-comment">-- * insertelement</span><span>
</span><span id="line-839"></span><span class="hs-comment">-- $insertelement</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- </span><span>
</span><span id="line-841"></span><span class="hs-comment">-- Takes a scalar source, a 0-D or 1-D destination vector and a dynamic index</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- position and inserts the source into the destination at the proper position.</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- </span><span>
</span><span id="line-844"></span><span class="hs-comment">-- Note that this instruction resembles vector.insert, but is restricted to 0-D</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- and 1-D vectors and relaxed to dynamic indices.</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- </span><span>
</span><span id="line-847"></span><span class="hs-comment">-- It is meant to be closer to LLVM\'s version:</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- https://llvm.org/docs/LangRef.html\#insertelement-instruction</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- </span><span>
</span><span id="line-850"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- </span><span>
</span><span id="line-852"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- %c = arith.constant 15 : i32</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- %f = arith.constant 0.0f : f32</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- %1 = vector.insertelement %f, %0[%c : i32]: vector\&lt;16xf32&gt;</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- %2 = vector.insertelement %f, %z[]: vector\&lt;f32&gt;</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-858"></span><span class="hs-comment">--   </span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- | A builder for @vector.insertelement@.</span><span>
</span><span id="line-861"></span><span id="local-6989586621679447803"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#insertelement"><span class="hs-identifier hs-type">insertelement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447803"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447803"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-862"></span><span id="insertelement"><span class="annot"><span class="annottext">insertelement :: Type -&gt; Value -&gt; Value -&gt; Maybe Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#insertelement"><span class="hs-identifier hs-var hs-var">insertelement</span></a></span></span><span> </span><span id="local-6989586621679447801"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447801"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447800"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447800"><span class="hs-identifier hs-var">source_</span></a></span></span><span> </span><span id="local-6989586621679447799"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447799"><span class="hs-identifier hs-var">dest_</span></a></span></span><span> </span><span id="local-6989586621679447798"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447798"><span class="hs-identifier hs-var">position_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-863"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-864"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.insertelement&quot;</span></span><span>
</span><span id="line-865"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-866"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447801"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447800"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447799"><span class="hs-identifier hs-var">dest_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; [Name]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">Data.Maybe.maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447798"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-869"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-870"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-comment">-- * insert_map</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- $insert_map</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- </span><span>
</span><span id="line-876"></span><span class="hs-comment">-- Inserts a N-D vector and within a larger vector starting at id. The new</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- vector created will have the same size as the destination operand vector.</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- </span><span>
</span><span id="line-879"></span><span class="hs-comment">-- The dimension associated to each element of @ids@ used to insert is</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- implicitly deduced from the source type (see @ExtractMapOp@ for details).</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- For example if source type is @vector\&lt;4x4x2xf32&gt;@ and the destination type</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- is @vector\&lt;64x4x32xf32&gt;@, the first id maps to dimension 0 and the second id</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- to dimension 2.</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- </span><span>
</span><span id="line-885"></span><span class="hs-comment">-- Similarly to vector.tuple_get, this operation is used for progressive</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- lowering and should be folded away before converting to LLVM.</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- </span><span>
</span><span id="line-888"></span><span class="hs-comment">-- It is different than @vector.insert@ and @vector.insert_strided_slice@ as it</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- takes a Value as index instead of an attribute. Also in the future it is</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- meant to support inserting along any dimensions and not only the most major</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- ones.</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- </span><span>
</span><span id="line-893"></span><span class="hs-comment">-- This operations is meant to be used in combination with vector.extract_map.</span><span>
</span><span id="line-894"></span><span class="hs-comment">-- </span><span>
</span><span id="line-895"></span><span class="hs-comment">-- For instance:</span><span>
</span><span id="line-896"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- // dynamic computation producing the value 0 of index type</span><span>
</span><span id="line-898"></span><span class="hs-comment">-- %idx0 = ... : index</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- // dynamic computation producing the value 1 of index type</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- %idx1 = ... : index /</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- %0 = arith.constant dense\&lt;0, 1, 2, 3&gt;: vector\&lt;4xi32&gt;</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- // extracts values [0, 1]</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- %1 = vector.extract_map %0[%idx0] : vector\&lt;4xi32&gt; to vector\&lt;2xi32&gt;</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- // extracts values [1, 2]</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- %2 = vector.extract_map %0[%idx1] : vector\&lt;4xi32&gt; to vector\&lt;2xi32&gt;</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- // insert [0, 1] into [x, x, x, x] and produce [0, 1, x, x]</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- %3 = vector.insert_map %1, %0[%idx0] : vector\&lt;2xi32&gt; into vector\&lt;4xi32&gt;</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- // insert [1, 2] into [x, x, x, x] and produce [x, 1, 2, x]</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- %4 = vector.insert_map %2, %0[%idx1] : vector\&lt;2xi32&gt; into vector\&lt;4xi32&gt;</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- </span><span>
</span><span id="line-913"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- %v = vector.insert_map %ev %v[%id] : vector\&lt;1xf32&gt; into vector\&lt;32xf32&gt;</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- %v1 = vector.insert_map %ev1, %v1[%arg0, %arg1] : vector\&lt;2x4x1xf32&gt;</span><span>
</span><span id="line-916"></span><span class="hs-comment">--   into vector\&lt;64x4x32xf32&gt;</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-918"></span><span class="hs-comment">--   </span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- | A builder for @vector.insert_map@.</span><span>
</span><span id="line-921"></span><span id="local-6989586621679447797"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#insert_map"><span class="hs-identifier hs-type">insert_map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447797"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447797"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-922"></span><span id="insert_map"><span class="annot"><span class="annottext">insert_map :: Type -&gt; Value -&gt; Value -&gt; [Value] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#insert_map"><span class="hs-identifier hs-var hs-var">insert_map</span></a></span></span><span> </span><span id="local-6989586621679447795"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447795"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447794"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447794"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447793"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447793"><span class="hs-identifier hs-var">dest_</span></a></span></span><span> </span><span id="local-6989586621679447792"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447792"><span class="hs-identifier hs-var">ids_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-924"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.insert_map&quot;</span></span><span>
</span><span id="line-925"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-926"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447795"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-927"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447794"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447793"><span class="hs-identifier hs-var">dest_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447792"><span class="hs-identifier hs-var">ids_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-929"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-930"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="hs-comment">-- * insert</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- $insert</span><span>
</span><span id="line-935"></span><span class="hs-comment">-- </span><span>
</span><span id="line-936"></span><span class="hs-comment">-- Takes an n-D source vector, an (n+k)-D destination vector and a k-D position</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- and inserts the n-D source into the (n+k)-D destination at the proper</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- position. Degenerates to a scalar source type when n = 0.</span><span>
</span><span id="line-939"></span><span class="hs-comment">-- </span><span>
</span><span id="line-940"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- </span><span>
</span><span id="line-942"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- %2 = vector.insert %0, %1[3] : vector\&lt;8x16xf32&gt; into vector\&lt;4x8x16xf32&gt;</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- %5 = vector.insert %3, %4[3, 3, 3] : f32 into vector\&lt;4x8x16xf32&gt;</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-946"></span><span class="hs-comment">--   </span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertOpAttributes"><span class="hs-identifier hs-type">InternalInsertOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-949"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalInsertOpAttributes"><span id="%24mInternalInsertOpAttributes"><span id="InternalInsertOpAttributes"><span class="annot"><span class="annottext">$bInternalInsertOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalInsertOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalInsertOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalInsertOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447788"><span class="hs-identifier hs-type">position_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447787"><span class="annot"><a href="#local-6989586621679447787"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;position&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447787"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447788"><span class="annot"><a href="#local-6989586621679447788"><span class="hs-identifier hs-var">position_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertOpAttributes"><span class="hs-identifier hs-var">InternalInsertOpAttributes</span></a></span><span> </span><span id="local-6989586621679447786"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447786"><span class="hs-identifier hs-var">position_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;position&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447786"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span class="hs-comment">-- | A pattern for @vector.insert@.</span><span>
</span><span id="line-953"></span><span id="local-6989586621679448077"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Insert"><span class="hs-identifier hs-type">Insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448077"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448077"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448077"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-954"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInsert"><span id="%24mInsert"><span id="Insert"><span class="annot"><span class="annottext">$bInsert :: Location
-&gt; Type -&gt; operand -&gt; operand -&gt; [Int] -&gt; AbstractOperation operand
$mInsert :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; operand -&gt; [Int] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInsert"><span class="hs-identifier hs-var hs-var hs-var">Insert</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447782"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447781"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447780"><span class="hs-identifier hs-type">source_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447779"><span class="hs-identifier hs-type">dest_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447778"><span class="hs-identifier hs-type">position_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-955"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.insert&quot;</span></span><span>
</span><span id="line-956"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447782"><span class="annot"><a href="#local-6989586621679447782"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-957"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447781"><span class="annot"><a href="#local-6989586621679447781"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-958"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447780"><span class="annot"><a href="#local-6989586621679447780"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447779"><span class="annot"><a href="#local-6989586621679447779"><span class="hs-identifier hs-var">dest_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-959"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-960"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-961"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertOpAttributes"><span class="hs-identifier hs-type">InternalInsertOpAttributes</span></a></span><span> </span><span id="local-6989586621679447778"><span class="annot"><a href="#local-6989586621679447778"><span class="hs-identifier hs-var">position_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="hs-comment">-- | A builder for @vector.insert@.</span><span>
</span><span id="line-965"></span><span id="local-6989586621679447777"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447777"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447777"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-966"></span><span id="insert"><span class="annot"><span class="annottext">insert :: Type -&gt; Value -&gt; Value -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679447775"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447775"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447774"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447774"><span class="hs-identifier hs-var">source_</span></a></span></span><span> </span><span id="local-6989586621679447773"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447773"><span class="hs-identifier hs-var">dest_</span></a></span></span><span> </span><span id="local-6989586621679447772"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447772"><span class="hs-identifier hs-var">position_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-967"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-968"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.insert&quot;</span></span><span>
</span><span id="line-969"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-970"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447775"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-971"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447774"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447773"><span class="hs-identifier hs-var">dest_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-972"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-973"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-974"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertOpAttributes"><span class="hs-identifier hs-var">InternalInsertOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447772"><span class="hs-identifier hs-var">position_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="hs-comment">-- * insert_strided_slice</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- $insert_strided_slice</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- </span><span>
</span><span id="line-980"></span><span class="hs-comment">-- Takes a k-D source vector, an n-D destination vector (n &gt;= k), n-sized</span><span>
</span><span id="line-981"></span><span class="hs-comment">-- @offsets@ integer array attribute, a k-sized @strides@ integer array attribute</span><span>
</span><span id="line-982"></span><span class="hs-comment">-- and inserts the k-D source vector as a strided subvector at the proper offset</span><span>
</span><span id="line-983"></span><span class="hs-comment">-- into the n-D destination vector.</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- </span><span>
</span><span id="line-985"></span><span class="hs-comment">-- At the moment strides must contain only 1s.</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- </span><span>
</span><span id="line-987"></span><span class="hs-comment">-- Returns an n-D vector that is a copy of the n-D destination vector in which</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- the last k-D dimensions contain the k-D source vector elements strided at</span><span>
</span><span id="line-989"></span><span class="hs-comment">-- the proper location as specified by the offsets.</span><span>
</span><span id="line-990"></span><span class="hs-comment">-- </span><span>
</span><span id="line-991"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-992"></span><span class="hs-comment">-- </span><span>
</span><span id="line-993"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-994"></span><span class="hs-comment">-- %2 = vector.insert_strided_slice %0, %1</span><span>
</span><span id="line-995"></span><span class="hs-comment">--     {offsets = [0, 0, 2], strides = [1, 1]}:</span><span>
</span><span id="line-996"></span><span class="hs-comment">--   vector\&lt;2x4xf32&gt; into vector\&lt;16x4x8xf32&gt;</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-998"></span><span class="hs-comment">--   </span><span>
</span><span id="line-999"></span><span>
</span><span id="line-1000"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertStridedSliceOpAttributes"><span class="hs-identifier hs-type">InternalInsertStridedSliceOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-1001"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalInsertStridedSliceOpAttributes"><span id="%24mInternalInsertStridedSliceOpAttributes"><span id="InternalInsertStridedSliceOpAttributes"><span class="annot"><span class="annottext">$bInternalInsertStridedSliceOpAttributes :: [Int] -&gt; [Int] -&gt; Map Name Attribute
$mInternalInsertStridedSliceOpAttributes :: forall r.
Map Name Attribute -&gt; ([Int] -&gt; [Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalInsertStridedSliceOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalInsertStridedSliceOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447768"><span class="hs-identifier hs-type">offsets_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447767"><span class="hs-identifier hs-type">strides_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447766"><span class="annot"><a href="#local-6989586621679447766"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;offsets&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447766"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;strides&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447766"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447768"><span class="annot"><a href="#local-6989586621679447768"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447767"><span class="annot"><a href="#local-6989586621679447767"><span class="hs-identifier hs-var">strides_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1002"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertStridedSliceOpAttributes"><span class="hs-identifier hs-var">InternalInsertStridedSliceOpAttributes</span></a></span><span> </span><span id="local-6989586621679447765"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447765"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447764"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447764"><span class="hs-identifier hs-var">strides_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;offsets&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447765"><span class="hs-identifier hs-var">offsets_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;strides&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447764"><span class="hs-identifier hs-var">strides_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1003"></span><span>
</span><span id="line-1004"></span><span class="hs-comment">-- | A pattern for @vector.insert_strided_slice@.</span><span>
</span><span id="line-1005"></span><span id="local-6989586621679448070"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InsertStridedSlice"><span class="hs-identifier hs-type">InsertStridedSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448070"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448070"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448070"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1006"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInsertStridedSlice"><span id="%24mInsertStridedSlice"><span id="InsertStridedSlice"><span class="annot"><span class="annottext">$bInsertStridedSlice :: Location
-&gt; Type
-&gt; operand
-&gt; operand
-&gt; [Int]
-&gt; [Int]
-&gt; AbstractOperation operand
$mInsertStridedSlice :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; operand -&gt; [Int] -&gt; [Int] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInsertStridedSlice"><span class="hs-identifier hs-var hs-var hs-var">InsertStridedSlice</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447760"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447759"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447758"><span class="hs-identifier hs-type">source_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447757"><span class="hs-identifier hs-type">dest_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447756"><span class="hs-identifier hs-type">offsets_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447755"><span class="hs-identifier hs-type">strides_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1007"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.insert_strided_slice&quot;</span></span><span>
</span><span id="line-1008"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447760"><span class="annot"><a href="#local-6989586621679447760"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1009"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447759"><span class="annot"><a href="#local-6989586621679447759"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1010"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447758"><span class="annot"><a href="#local-6989586621679447758"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447757"><span class="annot"><a href="#local-6989586621679447757"><span class="hs-identifier hs-var">dest_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1011"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1012"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1013"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertStridedSliceOpAttributes"><span class="hs-identifier hs-type">InternalInsertStridedSliceOpAttributes</span></a></span><span> </span><span id="local-6989586621679447756"><span class="annot"><a href="#local-6989586621679447756"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447755"><span class="annot"><a href="#local-6989586621679447755"><span class="hs-identifier hs-var">strides_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span class="hs-comment">-- | A builder for @vector.insert_strided_slice@.</span><span>
</span><span id="line-1017"></span><span id="local-6989586621679447754"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#insert_strided_slice"><span class="hs-identifier hs-type">insert_strided_slice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447754"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447754"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1018"></span><span id="insert_strided_slice"><span class="annot"><span class="annottext">insert_strided_slice :: Type -&gt; Value -&gt; Value -&gt; [Int] -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#insert_strided_slice"><span class="hs-identifier hs-var hs-var">insert_strided_slice</span></a></span></span><span> </span><span id="local-6989586621679447752"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447752"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447751"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447751"><span class="hs-identifier hs-var">source_</span></a></span></span><span> </span><span id="local-6989586621679447750"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447750"><span class="hs-identifier hs-var">dest_</span></a></span></span><span> </span><span id="local-6989586621679447749"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447749"><span class="hs-identifier hs-var">offsets_</span></a></span></span><span> </span><span id="local-6989586621679447748"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447748"><span class="hs-identifier hs-var">strides_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1019"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1020"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.insert_strided_slice&quot;</span></span><span>
</span><span id="line-1021"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1022"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447752"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1023"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447751"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447750"><span class="hs-identifier hs-var">dest_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1024"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1025"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalInsertStridedSliceOpAttributes"><span class="hs-identifier hs-var">InternalInsertStridedSliceOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447749"><span class="hs-identifier hs-var">offsets_</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447748"><span class="hs-identifier hs-var">strides_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- * load</span><span>
</span><span id="line-1030"></span><span class="hs-comment">-- $load</span><span>
</span><span id="line-1031"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1032"></span><span class="hs-comment">-- The \'vector.load\' operation reads an n-D slice of memory into an n-D</span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- vector. It takes a \'base\' memref, an index for each memref dimension and a</span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- result vector type as arguments. It returns a value of the result vector</span><span>
</span><span id="line-1035"></span><span class="hs-comment">-- type. The \'base\' memref and indices determine the start memory address from</span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- which to read. Each index provides an offset for each memref dimension</span><span>
</span><span id="line-1037"></span><span class="hs-comment">-- based on the element type of the memref. The shape of the result vector</span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- type determines the shape of the slice read from the start memory address.</span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- The elements along each dimension of the slice are strided by the memref</span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- strides. Only unit strides are allowed along the most minor memref</span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- dimension. These constraints guarantee that elements read along the first</span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- dimension of the slice are contiguous in memory.</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- The memref element type can be a scalar or a vector type. If the memref</span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- element type is a scalar, it should match the element type of the result</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- vector. If the memref element type is vector, it should match the result</span><span>
</span><span id="line-1047"></span><span class="hs-comment">-- vector type.</span><span>
</span><span id="line-1048"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- Example 1: 1-D vector load on a scalar memref.</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1051"></span><span class="hs-comment">-- %result = vector.load %base[%i, %j] : memref\&lt;100x100xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1052"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1053"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1054"></span><span class="hs-comment">-- Example 2: 1-D vector load on a vector memref.</span><span>
</span><span id="line-1055"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1056"></span><span class="hs-comment">-- %result = vector.load %memref[%i, %j] : memref\&lt;200x100xvector\&lt;8xf32&gt;&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1057"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- Example 3:  2-D vector load on a scalar memref.</span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- %result = vector.load %memref[%i, %j] : memref\&lt;200x100xf32&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1063"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- Example 4:  2-D vector load on a vector memref.</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- %result = vector.load %memref[%i, %j] : memref\&lt;200x100xvector\&lt;4x8xf32&gt;&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1067"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1069"></span><span class="hs-comment">-- Representation-wise, the \'vector.load\' operation permits out-of-bounds</span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- reads. Support and implementation of out-of-bounds vector loads is</span><span>
</span><span id="line-1071"></span><span class="hs-comment">-- target-specific. No assumptions should be made on the value of elements</span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- loaded out of bounds. Not all targets may support out-of-bounds vector</span><span>
</span><span id="line-1073"></span><span class="hs-comment">-- loads.</span><span>
</span><span id="line-1074"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- Example 5:  Potential out-of-bound vector load.</span><span>
</span><span id="line-1076"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- %result = vector.load %memref[%index] : memref\&lt;?xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1078"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1079"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1080"></span><span class="hs-comment">-- Example 6:  Explicit out-of-bound vector load.</span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1082"></span><span class="hs-comment">-- %result = vector.load %memref[%c0] : memref\&lt;7xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1083"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1084"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1085"></span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- | A builder for @vector.load@.</span><span>
</span><span id="line-1087"></span><span id="local-6989586621679447747"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#load"><span class="hs-identifier hs-type">load</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447747"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447747"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1088"></span><span id="load"><span class="annot"><span class="annottext">load :: Type -&gt; Value -&gt; [Value] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#load"><span class="hs-identifier hs-var hs-var">load</span></a></span></span><span> </span><span id="local-6989586621679447745"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447745"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447744"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447744"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447743"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447743"><span class="hs-identifier hs-var">indices_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1089"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1090"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.load&quot;</span></span><span>
</span><span id="line-1091"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1092"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447745"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1093"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447744"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447743"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1095"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1096"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1097"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- * maskedload</span><span>
</span><span id="line-1100"></span><span class="hs-comment">-- $maskedload</span><span>
</span><span id="line-1101"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- The masked load reads elements from memory into a 1-D vector as defined</span><span>
</span><span id="line-1103"></span><span class="hs-comment">-- by a base with indices and a 1-D mask vector. When the mask is set, the</span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- element is read from memory. Otherwise, the corresponding element is taken</span><span>
</span><span id="line-1105"></span><span class="hs-comment">-- from a 1-D pass-through vector. Informally the semantics are:</span><span>
</span><span id="line-1106"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1107"></span><span class="hs-comment">-- result[0] := mask[0] ? base[i+0] : pass_thru[0]</span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- result[1] := mask[1] ? base[i+1] : pass_thru[1]</span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-1110"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1111"></span><span class="hs-comment">-- The masked load can be used directly where applicable, or can be used</span><span>
</span><span id="line-1112"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-1113"></span><span class="hs-comment">-- hardware ISA support for a masked load. The semantics of the operation</span><span>
</span><span id="line-1114"></span><span class="hs-comment">-- closely correspond to those of the @llvm.masked.load@</span><span>
</span><span id="line-1115"></span><span class="hs-comment">-- intrinsic.</span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1119"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- %0 = vector.maskedload %base[%i], %mask, %pass_thru</span><span>
</span><span id="line-1121"></span><span class="hs-comment">--    : memref\&lt;?xf32&gt;, vector\&lt;8xi1&gt;, vector\&lt;8xf32&gt; into vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- %1 = vector.maskedload %base[%i, %j], %mask, %pass_thru</span><span>
</span><span id="line-1124"></span><span class="hs-comment">--    : memref\&lt;?x?xf32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt; into vector\&lt;16xf32&gt;</span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1126"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- | A builder for @vector.maskedload@.</span><span>
</span><span id="line-1129"></span><span id="local-6989586621679447742"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#maskedload"><span class="hs-identifier hs-type">maskedload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447742"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447742"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1130"></span><span id="maskedload"><span class="annot"><span class="annottext">maskedload :: Type -&gt; Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#maskedload"><span class="hs-identifier hs-var hs-var">maskedload</span></a></span></span><span> </span><span id="local-6989586621679447740"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447740"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447739"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447739"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447738"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447738"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447737"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447737"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447736"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447736"><span class="hs-identifier hs-var">pass_thru_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1131"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1132"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.maskedload&quot;</span></span><span>
</span><span id="line-1133"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1134"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447740"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1135"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447739"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447738"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447737"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447736"><span class="hs-identifier hs-var">pass_thru_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1136"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1137"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1138"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- * maskedstore</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- $maskedstore</span><span>
</span><span id="line-1143"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- The masked store operation writes elements from a 1-D vector into memory</span><span>
</span><span id="line-1145"></span><span class="hs-comment">-- as defined by a base with indices and a 1-D mask vector. When the mask is</span><span>
</span><span id="line-1146"></span><span class="hs-comment">-- set, the corresponding element from the vector is written to memory. Otherwise,</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- no action is taken for the element. Informally the semantics are:</span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- if (mask[0]) base[i+0] = value[0]</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- if (mask[1]) base[i+1] = value[1]</span><span>
</span><span id="line-1151"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-1152"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- The masked store can be used directly where applicable, or can be used</span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- hardware ISA support for a masked store. The semantics of the operation</span><span>
</span><span id="line-1156"></span><span class="hs-comment">-- closely correspond to those of the @llvm.masked.store@</span><span>
</span><span id="line-1157"></span><span class="hs-comment">-- intrinsic.</span><span>
</span><span id="line-1158"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1159"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1162"></span><span class="hs-comment">-- vector.maskedstore %base[%i], %mask, %value</span><span>
</span><span id="line-1163"></span><span class="hs-comment">--   : memref\&lt;?xf32&gt;, vector\&lt;8xi1&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1164"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1165"></span><span class="hs-comment">-- vector.maskedstore %base[%i, %j], %mask, %value</span><span>
</span><span id="line-1166"></span><span class="hs-comment">--   : memref\&lt;?x?xf32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt;</span><span>
</span><span id="line-1167"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1168"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1169"></span><span>
</span><span id="line-1170"></span><span class="hs-comment">-- | A builder for @vector.maskedstore@.</span><span>
</span><span id="line-1171"></span><span id="local-6989586621679447735"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#maskedstore"><span class="hs-identifier hs-type">maskedstore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447735"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447735"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1172"></span><span id="maskedstore"><span class="annot"><span class="annottext">maskedstore :: Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; m ()
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#maskedstore"><span class="hs-identifier hs-var hs-var">maskedstore</span></a></span></span><span>  </span><span id="local-6989586621679447733"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447733"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447732"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447732"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447731"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447731"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447730"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447730"><span class="hs-identifier hs-var">valueToStore_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1173"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1174"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.maskedstore&quot;</span></span><span>
</span><span id="line-1175"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1176"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1177"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447733"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447732"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447731"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447730"><span class="hs-identifier hs-var">valueToStore_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1179"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1180"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1181"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1182"></span><span>
</span><span id="line-1183"></span><span class="hs-comment">-- * matrix_multiply</span><span>
</span><span id="line-1184"></span><span class="hs-comment">-- $matrix_multiply</span><span>
</span><span id="line-1185"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1186"></span><span class="hs-comment">-- This is the counterpart of llvm.matrix.multiply in MLIR. It serves the</span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- purposes of more progressive lowering and localized type conversion.</span><span>
</span><span id="line-1188"></span><span class="hs-comment">-- Higher levels typically lower matrix multiplications into \'vector.contract\'</span><span>
</span><span id="line-1189"></span><span class="hs-comment">-- operations. Subsequent rewriting rule progressively lower these operations</span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- into \'vector.matrix_multiply\' operations to bring the operations closer</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- to the hardware ISA.</span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1193"></span><span class="hs-comment">-- The &#8216;vector.matrix_multiply&#8217; op treats @lhs@ as matrix with \&lt;lhs_rows&gt; rows</span><span>
</span><span id="line-1194"></span><span class="hs-comment">-- and \&lt;lhs_columns&gt; columns, @rhs@ as matrix with \&lt;lhs_columns&gt; rows and</span><span>
</span><span id="line-1195"></span><span class="hs-comment">-- \&lt;rhs_columns&gt; and multiplies them. The result matrix is returned embedded in</span><span>
</span><span id="line-1196"></span><span class="hs-comment">-- the result vector.</span><span>
</span><span id="line-1197"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1198"></span><span class="hs-comment">-- Also see:</span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- http://llvm.org/docs/LangRef.html\#llvm-matrix-multiply-intrinsic</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1203"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1204"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1205"></span><span class="hs-comment">-- %C = vector.matrix_multiply %A, %B</span><span>
</span><span id="line-1206"></span><span class="hs-comment">--   { lhs_rows = 4: i32, lhs_columns = 16: i32 , rhs_columns = 3: i32 } :</span><span>
</span><span id="line-1207"></span><span class="hs-comment">--   (vector\&lt;64xf64&gt;, vector\&lt;48xf64&gt;) -&gt; vector\&lt;12xf64&gt;</span><span>
</span><span id="line-1208"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1209"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1210"></span><span>
</span><span id="line-1211"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalMatmulOpAttributes"><span class="hs-identifier hs-type">InternalMatmulOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-1212"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalMatmulOpAttributes"><span id="%24mInternalMatmulOpAttributes"><span id="InternalMatmulOpAttributes"><span class="annot"><span class="annottext">$bInternalMatmulOpAttributes :: Int -&gt; Int -&gt; Int -&gt; Map Name Attribute
$mInternalMatmulOpAttributes :: forall r.
Map Name Attribute -&gt; (Int -&gt; Int -&gt; Int -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalMatmulOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalMatmulOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447726"><span class="hs-identifier hs-type">lhs_rows_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447725"><span class="hs-identifier hs-type">lhs_columns_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447724"><span class="hs-identifier hs-type">rhs_columns_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447723"><span class="annot"><a href="#local-6989586621679447723"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;lhs_rows&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;lhs_columns&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rhs_columns&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447726"><span class="annot"><a href="#local-6989586621679447726"><span class="hs-identifier hs-var">lhs_rows_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447725"><span class="annot"><a href="#local-6989586621679447725"><span class="hs-identifier hs-var">lhs_columns_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447724"><span class="annot"><a href="#local-6989586621679447724"><span class="hs-identifier hs-var">rhs_columns_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1213"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalMatmulOpAttributes"><span class="hs-identifier hs-var">InternalMatmulOpAttributes</span></a></span><span> </span><span id="local-6989586621679447722"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447722"><span class="hs-identifier hs-var">lhs_rows_</span></a></span></span><span> </span><span id="local-6989586621679447721"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447721"><span class="hs-identifier hs-var">lhs_columns_</span></a></span></span><span> </span><span id="local-6989586621679447720"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447720"><span class="hs-identifier hs-var">rhs_columns_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;lhs_rows&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447722"><span class="hs-identifier hs-var">lhs_rows_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;lhs_columns&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447721"><span class="hs-identifier hs-var">lhs_columns_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; [(Name, Attribute)] -&gt; [(Name, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;rhs_columns&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447720"><span class="hs-identifier hs-var">rhs_columns_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1214"></span><span>
</span><span id="line-1215"></span><span class="hs-comment">-- | A pattern for @vector.matrix_multiply@.</span><span>
</span><span id="line-1216"></span><span id="local-6989586621679448060"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Matmul"><span class="hs-identifier hs-type">Matmul</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448060"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448060"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448060"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1217"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bMatmul"><span id="%24mMatmul"><span id="Matmul"><span class="annot"><span class="annottext">$bMatmul :: Location
-&gt; Type
-&gt; operand
-&gt; operand
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; AbstractOperation operand
$mMatmul :: forall r operand.
AbstractOperation operand
-&gt; (Location
    -&gt; Type -&gt; operand -&gt; operand -&gt; Int -&gt; Int -&gt; Int -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bMatmul"><span class="hs-identifier hs-var hs-var hs-var">Matmul</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447716"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447715"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447714"><span class="hs-identifier hs-type">lhs_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447713"><span class="hs-identifier hs-type">rhs_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447712"><span class="hs-identifier hs-type">lhs_rows_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447711"><span class="hs-identifier hs-type">lhs_columns_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447710"><span class="hs-identifier hs-type">rhs_columns_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1218"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.matrix_multiply&quot;</span></span><span>
</span><span id="line-1219"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447716"><span class="annot"><a href="#local-6989586621679447716"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1220"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447715"><span class="annot"><a href="#local-6989586621679447715"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1221"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447714"><span class="annot"><a href="#local-6989586621679447714"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447713"><span class="annot"><a href="#local-6989586621679447713"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1222"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1223"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1224"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalMatmulOpAttributes"><span class="hs-identifier hs-type">InternalMatmulOpAttributes</span></a></span><span> </span><span id="local-6989586621679447712"><span class="annot"><a href="#local-6989586621679447712"><span class="hs-identifier hs-var">lhs_rows_</span></a></span></span><span> </span><span id="local-6989586621679447711"><span class="annot"><a href="#local-6989586621679447711"><span class="hs-identifier hs-var">lhs_columns_</span></a></span></span><span> </span><span id="local-6989586621679447710"><span class="annot"><a href="#local-6989586621679447710"><span class="hs-identifier hs-var">rhs_columns_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="hs-comment">-- | A builder for @vector.matrix_multiply@.</span><span>
</span><span id="line-1228"></span><span id="local-6989586621679447709"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#matrix_multiply"><span class="hs-identifier hs-type">matrix_multiply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447709"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447709"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1229"></span><span id="matrix_multiply"><span class="annot"><span class="annottext">matrix_multiply :: Type -&gt; Value -&gt; Value -&gt; Int -&gt; Int -&gt; Int -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#matrix_multiply"><span class="hs-identifier hs-var hs-var">matrix_multiply</span></a></span></span><span> </span><span id="local-6989586621679447707"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447707"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447706"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447706"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span> </span><span id="local-6989586621679447705"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447705"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span> </span><span id="local-6989586621679447704"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447704"><span class="hs-identifier hs-var">lhs_rows_</span></a></span></span><span> </span><span id="local-6989586621679447703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447703"><span class="hs-identifier hs-var">lhs_columns_</span></a></span></span><span> </span><span id="local-6989586621679447702"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447702"><span class="hs-identifier hs-var">rhs_columns_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1230"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1231"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.matrix_multiply&quot;</span></span><span>
</span><span id="line-1232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447707"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447706"><span class="hs-identifier hs-var">lhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447705"><span class="hs-identifier hs-var">rhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1235"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1236"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1237"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalMatmulOpAttributes"><span class="hs-identifier hs-var">InternalMatmulOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447704"><span class="hs-identifier hs-var">lhs_rows_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447703"><span class="hs-identifier hs-var">lhs_columns_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447702"><span class="hs-identifier hs-var">rhs_columns_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1238"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- * multi_reduction</span><span>
</span><span id="line-1241"></span><span class="hs-comment">-- $multi_reduction</span><span>
</span><span id="line-1242"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- Reduces an n-D vector into an (n-k)-D vector (or a scalar when k == n)</span><span>
</span><span id="line-1244"></span><span class="hs-comment">-- using the given operation (add/mul/min/max for int/fp and and/or/xor for</span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- int only).</span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- Takes an initial accumulator operand.</span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1248"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1249"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- %1 = vector.multi_reduction \&lt;add&gt;, %0, %acc0 [1, 3] :</span><span>
</span><span id="line-1252"></span><span class="hs-comment">--   vector\&lt;4x8x16x32xf32&gt; into vector\&lt;4x16xf32&gt;</span><span>
</span><span id="line-1253"></span><span class="hs-comment">-- %2 = vector.multi_reduction \&lt;add&gt;, %1, %acc1 [0, 1] :</span><span>
</span><span id="line-1254"></span><span class="hs-comment">--   vector\&lt;4x16xf32&gt; into f32</span><span>
</span><span id="line-1255"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1256"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span class="hs-comment">-- * outerproduct</span><span>
</span><span id="line-1259"></span><span class="hs-comment">-- $outerproduct</span><span>
</span><span id="line-1260"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- Takes 2 1-D vectors and returns the 2-D vector containing the outer-product,</span><span>
</span><span id="line-1262"></span><span class="hs-comment">-- as illustrated below:</span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1264"></span><span class="hs-comment">--  outer |   [c, d]</span><span>
</span><span id="line-1265"></span><span class="hs-comment">--  ------+------------</span><span>
</span><span id="line-1266"></span><span class="hs-comment">--    [a, | [ [a*c, a*d],</span><span>
</span><span id="line-1267"></span><span class="hs-comment">--     b] |   [b*c, b*d] ]</span><span>
</span><span id="line-1268"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1269"></span><span class="hs-comment">-- This operation also accepts a 1-D vector lhs and a scalar rhs. In this</span><span>
</span><span id="line-1270"></span><span class="hs-comment">-- case a simple AXPY operation is performed, which returns a 1-D vector.</span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1272"></span><span class="hs-comment">--     [a, b] * c = [a*c, b*c]</span><span>
</span><span id="line-1273"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- An optional extra vector argument with the same shape as the output</span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- vector may be specified in which case the operation returns the sum of</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- the outer-product and the extra vector. In this multiply-accumulate</span><span>
</span><span id="line-1278"></span><span class="hs-comment">-- scenario for floating-point arguments, the rounding mode is enforced</span><span>
</span><span id="line-1279"></span><span class="hs-comment">-- by guaranteeing that a fused-multiply add operation is emitted. When</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- lowered to the LLVMIR dialect, this form emits @llvm.intr.fma@, which</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- is guaranteed to lower to actual @fma@ instructions on x86.</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1283"></span><span class="hs-comment">-- An optional kind attribute may be specified to be add/mul/min/max</span><span>
</span><span id="line-1284"></span><span class="hs-comment">-- for int/fp, and and/or/xor for int only. The default is \&quot;add\&quot;, in which</span><span>
</span><span id="line-1285"></span><span class="hs-comment">-- case the operation returns a fused multiply-add. In other cases it returns</span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- a multiply followed by the appropriate operation (for example, a compare and</span><span>
</span><span id="line-1287"></span><span class="hs-comment">-- select for \&quot;max\&quot;).</span><span>
</span><span id="line-1288"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1289"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1290"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- %2 = vector.outerproduct %0, %1: vector\&lt;4xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- return %2: vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1294"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1295"></span><span class="hs-comment">-- %3 = vector.outerproduct %0, %1, %2:</span><span>
</span><span id="line-1296"></span><span class="hs-comment">--   vector\&lt;4xf32&gt;, vector\&lt;8xf32&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- return %3: vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1299"></span><span class="hs-comment">-- %4 = vector.outerproduct %0, %1, %2 {kind = \#vector.kind\&lt;max&gt;}:</span><span>
</span><span id="line-1300"></span><span class="hs-comment">--   vector\&lt;4xf32&gt;, vector\&lt;8xf32&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1301"></span><span class="hs-comment">-- return %3: vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- %6 = vector.outerproduct %4, %5: vector\&lt;10xf32&gt;, f32</span><span>
</span><span id="line-1304"></span><span class="hs-comment">-- return %6: vector\&lt;10xf32&gt;</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1307"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1308"></span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- | A builder for @vector.outerproduct@.</span><span>
</span><span id="line-1310"></span><span id="local-6989586621679447701"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#outerproduct"><span class="hs-identifier hs-type">outerproduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1311"></span><span id="outerproduct"><span class="annot"><span class="annottext">outerproduct :: Type -&gt; Value -&gt; Value -&gt; [Value] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#outerproduct"><span class="hs-identifier hs-var hs-var">outerproduct</span></a></span></span><span> </span><span id="local-6989586621679447699"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447699"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447698"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447698"><span class="hs-identifier hs-var">lhs_</span></a></span></span><span> </span><span id="local-6989586621679447697"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447697"><span class="hs-identifier hs-var">rhs_</span></a></span></span><span> </span><span id="local-6989586621679447696"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447696"><span class="hs-identifier hs-var">acc_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1312"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1313"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.outerproduct&quot;</span></span><span>
</span><span id="line-1314"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1315"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447699"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1316"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447698"><span class="hs-identifier hs-var">lhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447697"><span class="hs-identifier hs-var">rhs_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447696"><span class="hs-identifier hs-var">acc_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1317"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1318"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1319"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1320"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1321"></span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- * print</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- $print</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- Prints the source vector (or scalar) to stdout in human readable</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- format (for testing and debugging). No return value.</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1328"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1329"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1330"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1331"></span><span class="hs-comment">-- %0 = arith.constant 0.0 : f32</span><span>
</span><span id="line-1332"></span><span class="hs-comment">-- %1 = vector.broadcast %0 : f32 to vector\&lt;4xf32&gt;</span><span>
</span><span id="line-1333"></span><span class="hs-comment">-- vector.print %1 : vector\&lt;4xf32&gt;</span><span>
</span><span id="line-1334"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- when lowered to LLVM, the vector print is unrolled into</span><span>
</span><span id="line-1336"></span><span class="hs-comment">-- elementary printing method calls that at runtime will yield</span><span>
</span><span id="line-1337"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1338"></span><span class="hs-comment">-- ( 0.0, 0.0, 0.0, 0.0 )</span><span>
</span><span id="line-1339"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1340"></span><span class="hs-comment">-- on stdout when linked with a small runtime support library,</span><span>
</span><span id="line-1341"></span><span class="hs-comment">-- which only needs to provide a few printing methods (single</span><span>
</span><span id="line-1342"></span><span class="hs-comment">-- value for all data types, opening/closing bracket, comma,</span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- newline).</span><span>
</span><span id="line-1344"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1345"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1346"></span><span>
</span><span id="line-1347"></span><span class="hs-comment">-- | A pattern for @vector.print@.</span><span>
</span><span id="line-1348"></span><span id="local-6989586621679448054"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Print"><span class="hs-identifier hs-type">Print</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679448054"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448054"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1349"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPrint"><span id="%24mPrint"><span id="Print"><span class="annot"><span class="annottext">$bPrint :: Location -&gt; operand -&gt; AbstractOperation operand
$mPrint :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bPrint"><span class="hs-identifier hs-var hs-var hs-var">Print</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447692"><span class="hs-identifier hs-type">loc</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679447691"><span class="hs-identifier hs-type">source_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1350"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.print&quot;</span></span><span>
</span><span id="line-1351"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447692"><span class="annot"><a href="#local-6989586621679447692"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1352"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1353"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447691"><span class="annot"><a href="#local-6989586621679447691"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1354"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1355"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1356"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1357"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="hs-comment">-- | A builder for @vector.print@.</span><span>
</span><span id="line-1360"></span><span id="local-6989586621679447690"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#print"><span class="hs-identifier hs-type">print</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1361"></span><span id="print"><span class="annot"><span class="annottext">print :: Value -&gt; m ()
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#print"><span class="hs-identifier hs-var hs-var">print</span></a></span></span><span>  </span><span id="local-6989586621679447688"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447688"><span class="hs-identifier hs-var">source_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1362"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1363"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.print&quot;</span></span><span>
</span><span id="line-1364"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1365"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1366"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447688"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1367"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1368"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1369"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1370"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1371"></span><span>
</span><span id="line-1372"></span><span class="hs-comment">-- * reduction</span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- $reduction</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- Reduces an 1-D vector \&quot;horizontally\&quot; into a scalar using the given</span><span>
</span><span id="line-1376"></span><span class="hs-comment">-- operation (add/mul/min/max for int/fp and and/or/xor for int only).</span><span>
</span><span id="line-1377"></span><span class="hs-comment">-- Reductions also allow an optional fused accumulator.</span><span>
</span><span id="line-1378"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- Note that these operations are restricted to 1-D vectors to remain</span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- close to the corresponding LLVM intrinsics:</span><span>
</span><span id="line-1381"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1382"></span><span class="hs-comment">-- http://llvm.org/docs/LangRef.html\#vector-reduction-intrinsics</span><span>
</span><span id="line-1383"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1384"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1386"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1387"></span><span class="hs-comment">-- %1 = vector.reduction \&lt;add&gt;, %0 : vector\&lt;16xf32&gt; into f32</span><span>
</span><span id="line-1388"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1389"></span><span class="hs-comment">-- %3 = vector.reduction \&lt;xor&gt;, %2 : vector\&lt;4xi32&gt; into i32</span><span>
</span><span id="line-1390"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1391"></span><span class="hs-comment">-- %4 = vector.reduction \&lt;mul&gt;, %0, %1 : vector\&lt;16xf32&gt; into f32</span><span>
</span><span id="line-1392"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1393"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- * reshape</span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- $reshape</span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1398"></span><span class="hs-comment">-- Reshapes its vector operand from \'input_shape\' to \'output_shape\' maintaining</span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- fixed vector dimension \'fixed_vector_sizes\' on the innermost vector</span><span>
</span><span id="line-1400"></span><span class="hs-comment">-- dimensions.</span><span>
</span><span id="line-1401"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1402"></span><span class="hs-comment">-- The parameters \'input_shape\' and \'output_shape\' represent valid data shapes</span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- across fixed vector shapes. For example, if a vector has a valid data</span><span>
</span><span id="line-1404"></span><span class="hs-comment">-- shape [6] with fixed vector size [8], then the valid data elements are</span><span>
</span><span id="line-1405"></span><span class="hs-comment">-- assumed to be stored at the beginning of the vector with the remaining</span><span>
</span><span id="line-1406"></span><span class="hs-comment">-- vector elements undefined.</span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- In the examples below, valid data elements are represented by an alphabetic</span><span>
</span><span id="line-1409"></span><span class="hs-comment">-- character, and undefined data elements are represented by \'-\'.</span><span>
</span><span id="line-1410"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1411"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-1412"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1413"></span><span class="hs-comment">--   vector\&lt;1x8xf32&gt; with valid data shape [6], fixed vector sizes [8]</span><span>
</span><span id="line-1414"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1415"></span><span class="hs-comment">--             input: [a, b, c, d, e, f]</span><span>
</span><span id="line-1416"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1417"></span><span class="hs-comment">--        layout map: (d0) -&gt; (d0 floordiv 8, d0 mod 8)</span><span>
</span><span id="line-1418"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1419"></span><span class="hs-comment">--     vector layout: [a, b, c, d, e, f, -, -]</span><span>
</span><span id="line-1420"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1423"></span><span class="hs-comment">--   vector\&lt;2x8xf32&gt; with valid data shape [10], fixed vector sizes [8]</span><span>
</span><span id="line-1424"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1425"></span><span class="hs-comment">--             input: [a, b, c, d, e, f, g, h, i, j]</span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1427"></span><span class="hs-comment">--        layout map: (d0) -&gt; (d0 floordiv 8, d0 mod 8)</span><span>
</span><span id="line-1428"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1429"></span><span class="hs-comment">--     vector layout: [[a, b, c, d, e, f, g, h],</span><span>
</span><span id="line-1430"></span><span class="hs-comment">--                     [i, j, -, -, -, -, -, -]]</span><span>
</span><span id="line-1431"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1432"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-1433"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1434"></span><span class="hs-comment">--   vector\&lt;2x2x2x3xf32&gt; with valid data shape [3, 5], fixed vector sizes</span><span>
</span><span id="line-1435"></span><span class="hs-comment">--   [2, 3]</span><span>
</span><span id="line-1436"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1437"></span><span class="hs-comment">--             input: [[a, b, c, d, e],</span><span>
</span><span id="line-1438"></span><span class="hs-comment">--                     [f, g, h, i, j],</span><span>
</span><span id="line-1439"></span><span class="hs-comment">--                     [k, l, m, n, o]]</span><span>
</span><span id="line-1440"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1441"></span><span class="hs-comment">--        layout map: (d0, d1) -&gt; (d0 floordiv 3, d1 floordiv 5,</span><span>
</span><span id="line-1442"></span><span class="hs-comment">--                                 d0 mod 3, d1 mod 5)</span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1444"></span><span class="hs-comment">--     vector layout: [[[[a, b, c],</span><span>
</span><span id="line-1445"></span><span class="hs-comment">--                       [f, g, h]]</span><span>
</span><span id="line-1446"></span><span class="hs-comment">--                      [[d, e, -],</span><span>
</span><span id="line-1447"></span><span class="hs-comment">--                       [i, j, -]]],</span><span>
</span><span id="line-1448"></span><span class="hs-comment">--                     [[[k, l, m],</span><span>
</span><span id="line-1449"></span><span class="hs-comment">--                       [-, -, -]]</span><span>
</span><span id="line-1450"></span><span class="hs-comment">--                      [[n, o, -],</span><span>
</span><span id="line-1451"></span><span class="hs-comment">--                       [-, -, -]]]]</span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-1454"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1455"></span><span class="hs-comment">--   %1 = vector.reshape %0, [%c3, %c6], [%c2, %c9], [4]</span><span>
</span><span id="line-1456"></span><span class="hs-comment">--     : vector\&lt;3x2x4xf32&gt; to vector\&lt;2x3x4xf32&gt;</span><span>
</span><span id="line-1457"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1458"></span><span class="hs-comment">--          input: [[a, b, c, d, e, f],</span><span>
</span><span id="line-1459"></span><span class="hs-comment">--                  [g, h, i, j, k, l],</span><span>
</span><span id="line-1460"></span><span class="hs-comment">--                  [m, n, o, p, q, r]]</span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1462"></span><span class="hs-comment">--     layout map: (d0, d1) -&gt; (d0, d1 floordiv 4, d1 mod 4)</span><span>
</span><span id="line-1463"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1464"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1465"></span><span class="hs-comment">--   Input vector:  [[[a, b, c, d],</span><span>
</span><span id="line-1466"></span><span class="hs-comment">--                    [e, f, -, -]],</span><span>
</span><span id="line-1467"></span><span class="hs-comment">--                   [[g, h, i, j],</span><span>
</span><span id="line-1468"></span><span class="hs-comment">--                    [k, l, -, -]],</span><span>
</span><span id="line-1469"></span><span class="hs-comment">--                   [[m, n, o, p],</span><span>
</span><span id="line-1470"></span><span class="hs-comment">--                    [q, r, -, -]]]</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1472"></span><span class="hs-comment">--   Output vector:  [[[a, b, c, d],</span><span>
</span><span id="line-1473"></span><span class="hs-comment">--                     [e, f, g, h],</span><span>
</span><span id="line-1474"></span><span class="hs-comment">--                     [i, -, -, -]],</span><span>
</span><span id="line-1475"></span><span class="hs-comment">--                    [[j, k, l, m],</span><span>
</span><span id="line-1476"></span><span class="hs-comment">--                     [n, o, p, q],</span><span>
</span><span id="line-1477"></span><span class="hs-comment">--                     [r, -, -, -]]]</span><span>
</span><span id="line-1478"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalReshapeOpAttributes"><span class="hs-identifier hs-type">InternalReshapeOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-1481"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalReshapeOpAttributes"><span id="%24mInternalReshapeOpAttributes"><span id="InternalReshapeOpAttributes"><span class="annot"><span class="annottext">$bInternalReshapeOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalReshapeOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalReshapeOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalReshapeOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447684"><span class="hs-identifier hs-type">fixed_vector_sizes_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447683"><span class="annot"><a href="#local-6989586621679447683"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;fixed_vector_sizes&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447683"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447684"><span class="annot"><a href="#local-6989586621679447684"><span class="hs-identifier hs-var">fixed_vector_sizes_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1482"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalReshapeOpAttributes"><span class="hs-identifier hs-var">InternalReshapeOpAttributes</span></a></span><span> </span><span id="local-6989586621679447682"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447682"><span class="hs-identifier hs-var">fixed_vector_sizes_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;fixed_vector_sizes&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447682"><span class="hs-identifier hs-var">fixed_vector_sizes_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1483"></span><span>
</span><span id="line-1484"></span><span class="hs-comment">-- | A builder for @vector.reshape@.</span><span>
</span><span id="line-1485"></span><span id="local-6989586621679447681"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#reshape"><span class="hs-identifier hs-type">reshape</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447681"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447681"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1486"></span><span id="reshape"><span class="annot"><span class="annottext">reshape :: Type -&gt; Value -&gt; [Value] -&gt; [Value] -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#reshape"><span class="hs-identifier hs-var hs-var">reshape</span></a></span></span><span> </span><span id="local-6989586621679447679"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447679"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447678"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447678"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447677"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447677"><span class="hs-identifier hs-var">input_shape_</span></a></span></span><span> </span><span id="local-6989586621679447676"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447676"><span class="hs-identifier hs-var">output_shape_</span></a></span></span><span> </span><span id="local-6989586621679447675"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447675"><span class="hs-identifier hs-var">fixed_vector_sizes_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1487"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1488"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.reshape&quot;</span></span><span>
</span><span id="line-1489"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1490"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447679"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1491"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447678"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447677"><span class="hs-identifier hs-var">input_shape_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447676"><span class="hs-identifier hs-var">output_shape_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1492"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1493"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1494"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalReshapeOpAttributes"><span class="hs-identifier hs-var">InternalReshapeOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447675"><span class="hs-identifier hs-var">fixed_vector_sizes_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1495"></span><span>              </span><span class="annot"><span class="annottext">Map Name Attribute -&gt; Map Name Attribute -&gt; Map Name Attribute
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Attribute -&gt; Map Name Attribute
</span><a href="MLIR.AST.html#namedAttribute"><span class="hs-identifier hs-var">AST.namedAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;operand_segment_sizes&quot;</span></span><span>
</span><span id="line-1496"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DenseElements -&gt; Attribute
</span><a href="MLIR.AST.html#DenseElementsAttr"><span class="hs-identifier hs-var">DenseElementsAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Type -&gt; Type
</span><a href="MLIR.AST.html#VectorType"><span class="hs-identifier hs-var">VectorType</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Unsigned"><span class="hs-identifier hs-var">Unsigned</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DenseElements -&gt; Attribute) -&gt; DenseElements -&gt; Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1497"></span><span>                      </span><span class="annot"><span class="annottext">IStorableArray Int Word32 -&gt; DenseElements
forall i.
(Show i, Ix i) =&gt;
IStorableArray i Word32 -&gt; DenseElements
</span><a href="MLIR.AST.html#DenseUInt32"><span class="hs-identifier hs-var">DenseUInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(IStorableArray Int Word32 -&gt; DenseElements)
-&gt; IStorableArray Int Word32 -&gt; DenseElements
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word32] -&gt; IStorableArray Int Word32
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><span class="hs-identifier hs-var">IArray.listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word32] -&gt; IStorableArray Int Word32)
-&gt; [Word32] -&gt; IStorableArray Int Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">Prelude.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; [Int] -&gt; [Word32]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447677"><span class="hs-identifier hs-var">input_shape_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447676"><span class="hs-identifier hs-var">output_shape_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1500"></span><span>
</span><span id="line-1501"></span><span class="hs-comment">-- * scan</span><span>
</span><span id="line-1502"></span><span class="hs-comment">-- $scan</span><span>
</span><span id="line-1503"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1504"></span><span class="hs-comment">-- Performs an inclusive/exclusive scan on an n-D vector along a single</span><span>
</span><span id="line-1505"></span><span class="hs-comment">-- dimension returning an n-D result vector using the given</span><span>
</span><span id="line-1506"></span><span class="hs-comment">-- operation (add/mul/min/max for int/fp and and/or/xor for</span><span>
</span><span id="line-1507"></span><span class="hs-comment">-- int only) and a specified value for the initial value. The operator</span><span>
</span><span id="line-1508"></span><span class="hs-comment">-- returns the result of scan as well as the result of the last</span><span>
</span><span id="line-1509"></span><span class="hs-comment">-- reduction in the scan.</span><span>
</span><span id="line-1510"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1511"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1512"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1513"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- %1:2 = vector.scan \&lt;add&gt;, %0, %acc {inclusive = false, reduction_dim = 1 : i64} :</span><span>
</span><span id="line-1515"></span><span class="hs-comment">--   vector\&lt;4x8x16x32xf32&gt;, vector\&lt;4x16x32xf32&gt;</span><span>
</span><span id="line-1516"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1517"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1518"></span><span>
</span><span id="line-1519"></span><span class="hs-comment">-- * scatter</span><span>
</span><span id="line-1520"></span><span class="hs-comment">-- $scatter</span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1522"></span><span class="hs-comment">-- The scatter operation scatters elements from a 1-D vector into memory as</span><span>
</span><span id="line-1523"></span><span class="hs-comment">-- defined by a base with indices and an additional 1-D index vector, but</span><span>
</span><span id="line-1524"></span><span class="hs-comment">-- only if the corresponding bit in a 1-D mask vector is set. Otherwise, no</span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- action is taken for that element. Informally the semantics are:</span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1527"></span><span class="hs-comment">-- if (mask[0]) base[index[0]] = value[0]</span><span>
</span><span id="line-1528"></span><span class="hs-comment">-- if (mask[1]) base[index[1]] = value[1]</span><span>
</span><span id="line-1529"></span><span class="hs-comment">-- etc.</span><span>
</span><span id="line-1530"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1531"></span><span class="hs-comment">-- The vector dialect leaves out-of-bounds and repeated index behavior</span><span>
</span><span id="line-1532"></span><span class="hs-comment">-- undefined. Underlying implementations may enforce strict sequential</span><span>
</span><span id="line-1533"></span><span class="hs-comment">-- semantics for the latter, though.</span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- TODO: enforce the latter always?</span><span>
</span><span id="line-1535"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1536"></span><span class="hs-comment">-- The scatter operation can be used directly where applicable, or can be used</span><span>
</span><span id="line-1537"></span><span class="hs-comment">-- during progressively lowering to bring other memory operations closer to</span><span>
</span><span id="line-1538"></span><span class="hs-comment">-- hardware ISA support for a scatter. The semantics of the operation closely</span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- correspond to those of the @llvm.masked.scatter@</span><span>
</span><span id="line-1540"></span><span class="hs-comment">-- intrinsic.</span><span>
</span><span id="line-1541"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1542"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-1543"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1544"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- vector.scatter %base[%c0][%v], %mask, %value</span><span>
</span><span id="line-1546"></span><span class="hs-comment">--     : memref\&lt;?xf32&gt;, vector\&lt;16xi32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt;</span><span>
</span><span id="line-1547"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1548"></span><span class="hs-comment">-- vector.scatter %base[%i, %j][%v], %mask, %value</span><span>
</span><span id="line-1549"></span><span class="hs-comment">--     : memref\&lt;16x16xf32&gt;, vector\&lt;16xi32&gt;, vector\&lt;16xi1&gt;, vector\&lt;16xf32&gt;</span><span>
</span><span id="line-1550"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1551"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1552"></span><span>
</span><span id="line-1553"></span><span class="hs-comment">-- | A builder for @vector.scatter@.</span><span>
</span><span id="line-1554"></span><span id="local-6989586621679447667"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#scatter"><span class="hs-identifier hs-type">scatter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447667"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447667"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1555"></span><span id="scatter"><span class="annot"><span class="annottext">scatter :: Value -&gt; [Value] -&gt; Value -&gt; Value -&gt; Value -&gt; m ()
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#scatter"><span class="hs-identifier hs-var hs-var">scatter</span></a></span></span><span>  </span><span id="local-6989586621679447665"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447665"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447664"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447664"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447663"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447663"><span class="hs-identifier hs-var">index_vec_</span></a></span></span><span> </span><span id="local-6989586621679447662"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447662"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447661"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447661"><span class="hs-identifier hs-var">valueToStore_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1556"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1557"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.scatter&quot;</span></span><span>
</span><span id="line-1558"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1559"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1560"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447665"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447664"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447663"><span class="hs-identifier hs-var">index_vec_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447662"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447661"><span class="hs-identifier hs-var">valueToStore_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1561"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1562"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1563"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1564"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1565"></span><span>
</span><span id="line-1566"></span><span class="hs-comment">-- * shape_cast</span><span>
</span><span id="line-1567"></span><span class="hs-comment">-- $shape_cast</span><span>
</span><span id="line-1568"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1569"></span><span class="hs-comment">-- The shape_cast operation casts between an n-D source vector shape and</span><span>
</span><span id="line-1570"></span><span class="hs-comment">-- a k-D result vector shape (the element type remains the same).</span><span>
</span><span id="line-1571"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1572"></span><span class="hs-comment">-- If reducing rank (n &gt; k), result dimension sizes must be a product</span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- of contiguous source dimension sizes.</span><span>
</span><span id="line-1574"></span><span class="hs-comment">-- If expanding rank (n \&lt; k), source dimensions must factor into a</span><span>
</span><span id="line-1575"></span><span class="hs-comment">-- contiguous sequence of destination dimension sizes.</span><span>
</span><span id="line-1576"></span><span class="hs-comment">-- Each source dim is expanded (or contiguous sequence of source dims combined)</span><span>
</span><span id="line-1577"></span><span class="hs-comment">-- in source dimension list order (i.e. 0 \&lt;= i \&lt; n), to produce a contiguous</span><span>
</span><span id="line-1578"></span><span class="hs-comment">-- sequence of result dims (or a single result dim), in result dimension list</span><span>
</span><span id="line-1579"></span><span class="hs-comment">-- order (i.e. 0 \&lt;= j \&lt; k). The product of all source dimension sizes and all</span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- result dimension sizes must match.</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1582"></span><span class="hs-comment">-- It is currently assumed that this operation does not require moving data,</span><span>
</span><span id="line-1583"></span><span class="hs-comment">-- and that it will be folded away before lowering vector operations.</span><span>
</span><span id="line-1584"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1585"></span><span class="hs-comment">-- There is an exception to the folding expectation when targeting</span><span>
</span><span id="line-1586"></span><span class="hs-comment">-- llvm.intr.matrix operations. We need a type conversion back and forth from a</span><span>
</span><span id="line-1587"></span><span class="hs-comment">-- 2-D MLIR vector to a 1-D flattened LLVM vector.shape_cast lowering to LLVM</span><span>
</span><span id="line-1588"></span><span class="hs-comment">-- is supported in that particular case, for now.</span><span>
</span><span id="line-1589"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1590"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1591"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1593"></span><span class="hs-comment">-- // Example casting to a lower vector rank.</span><span>
</span><span id="line-1594"></span><span class="hs-comment">-- %1 = vector.shape_cast %0 : vector\&lt;5x1x4x3xf32&gt; to vector\&lt;20x3xf32&gt;</span><span>
</span><span id="line-1595"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1596"></span><span class="hs-comment">-- // Example casting to a higher vector rank.</span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- %3 = vector.shape_cast %2 : vector\&lt;10x12x8xf32&gt; to vector\&lt;5x2x3x4x8xf32&gt;</span><span>
</span><span id="line-1598"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1600"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span class="hs-comment">-- | A pattern for @vector.shape_cast@.</span><span>
</span><span id="line-1603"></span><span id="local-6989586621679447660"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#ShapeCast"><span class="hs-identifier hs-type">ShapeCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447660"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447660"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1604"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bShapeCast"><span id="%24mShapeCast"><span id="ShapeCast"><span class="annot"><span class="annottext">$bShapeCast :: Location -&gt; Type -&gt; operand -&gt; AbstractOperation operand
$mShapeCast :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bShapeCast"><span class="hs-identifier hs-var hs-var hs-var">ShapeCast</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447656"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447655"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447654"><span class="hs-identifier hs-type">source_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1605"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.shape_cast&quot;</span></span><span>
</span><span id="line-1606"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447656"><span class="annot"><a href="#local-6989586621679447656"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1607"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447655"><span class="annot"><a href="#local-6989586621679447655"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1608"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447654"><span class="annot"><a href="#local-6989586621679447654"><span class="hs-identifier hs-var">source_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1609"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1610"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1611"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1612"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1613"></span><span>
</span><span id="line-1614"></span><span class="hs-comment">-- | A builder for @vector.shape_cast@.</span><span>
</span><span id="line-1615"></span><span id="local-6989586621679447653"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#shape_cast"><span class="hs-identifier hs-type">shape_cast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447653"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447653"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1616"></span><span id="shape_cast"><span class="annot"><span class="annottext">shape_cast :: Type -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#shape_cast"><span class="hs-identifier hs-var hs-var">shape_cast</span></a></span></span><span> </span><span id="local-6989586621679447651"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447651"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447650"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447650"><span class="hs-identifier hs-var">source_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1617"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1618"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.shape_cast&quot;</span></span><span>
</span><span id="line-1619"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1620"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447651"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1621"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447650"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1622"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1623"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1624"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1626"></span><span>
</span><span id="line-1627"></span><span class="hs-comment">-- * shuffle</span><span>
</span><span id="line-1628"></span><span class="hs-comment">-- $shuffle</span><span>
</span><span id="line-1629"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1630"></span><span class="hs-comment">-- The shuffle operation constructs a permutation (or duplication) of elements</span><span>
</span><span id="line-1631"></span><span class="hs-comment">-- from two input vectors, returning a vector with the same element type as</span><span>
</span><span id="line-1632"></span><span class="hs-comment">-- the input and a length that is the same as the shuffle mask. The two input</span><span>
</span><span id="line-1633"></span><span class="hs-comment">-- vectors must have the same element type, rank, and trailing dimension sizes</span><span>
</span><span id="line-1634"></span><span class="hs-comment">-- and shuffles their values in the leading dimension (which may differ in size)</span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- according to the given mask. The legality rules are:</span><span>
</span><span id="line-1636"></span><span class="hs-comment">-- * the two operands must have the same element type as the result</span><span>
</span><span id="line-1637"></span><span class="hs-comment">-- * the two operands and the result must have the same rank and trailing</span><span>
</span><span id="line-1638"></span><span class="hs-comment">--   dimension sizes, viz. given two k-D operands</span><span>
</span><span id="line-1639"></span><span class="hs-comment">--           v1 : \&lt;s_1 x s_2 x .. x s_k x type&gt; and</span><span>
</span><span id="line-1640"></span><span class="hs-comment">--           v2 : \&lt;t_1 x t_2 x .. x t_k x type&gt;</span><span>
</span><span id="line-1641"></span><span class="hs-comment">--   we have s_i = t_i for all 1 \&lt; i \&lt;= k</span><span>
</span><span id="line-1642"></span><span class="hs-comment">-- * the mask length equals the leading dimension size of the result</span><span>
</span><span id="line-1643"></span><span class="hs-comment">-- * numbering the input vector indices left to right across the operands, all</span><span>
</span><span id="line-1644"></span><span class="hs-comment">--   mask values must be within range, viz. given two k-D operands v1 and v2</span><span>
</span><span id="line-1645"></span><span class="hs-comment">--   above, all mask values are in the range [0,s_1+t_1)</span><span>
</span><span id="line-1646"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1647"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1648"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1649"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1650"></span><span class="hs-comment">-- %0 = vector.shuffle %a, %b[0, 3]</span><span>
</span><span id="line-1651"></span><span class="hs-comment">--            : vector\&lt;2xf32&gt;, vector\&lt;2xf32&gt;       ; yields vector\&lt;2xf32&gt;</span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- %1 = vector.shuffle %c, %b[0, 1, 2]</span><span>
</span><span id="line-1653"></span><span class="hs-comment">--            : vector\&lt;2x16xf32&gt;, vector\&lt;1x16xf32&gt; ; yields vector\&lt;3x16xf32&gt;</span><span>
</span><span id="line-1654"></span><span class="hs-comment">-- %2 = vector.shuffle %a, %b[3, 2, 1, 0]</span><span>
</span><span id="line-1655"></span><span class="hs-comment">--            : vector\&lt;2xf32&gt;, vector\&lt;2xf32&gt;       ; yields vector\&lt;4xf32&gt;</span><span>
</span><span id="line-1656"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1657"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1658"></span><span>
</span><span id="line-1659"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalShuffleOpAttributes"><span class="hs-identifier hs-type">InternalShuffleOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-1660"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalShuffleOpAttributes"><span id="%24mInternalShuffleOpAttributes"><span id="InternalShuffleOpAttributes"><span class="annot"><span class="annottext">$bInternalShuffleOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalShuffleOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalShuffleOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalShuffleOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447646"><span class="hs-identifier hs-type">mask_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447645"><span class="annot"><a href="#local-6989586621679447645"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;mask&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447645"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447646"><span class="annot"><a href="#local-6989586621679447646"><span class="hs-identifier hs-var">mask_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1661"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalShuffleOpAttributes"><span class="hs-identifier hs-var">InternalShuffleOpAttributes</span></a></span><span> </span><span id="local-6989586621679447644"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447644"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mask&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447644"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span class="hs-comment">-- | A pattern for @vector.shuffle@.</span><span>
</span><span id="line-1664"></span><span id="local-6989586621679447643"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Shuffle"><span class="hs-identifier hs-type">Shuffle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447643"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447643"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447643"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1665"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bShuffle"><span id="%24mShuffle"><span id="Shuffle"><span class="annot"><span class="annottext">$bShuffle :: Location
-&gt; Type -&gt; operand -&gt; operand -&gt; [Int] -&gt; AbstractOperation operand
$mShuffle :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; operand -&gt; [Int] -&gt; r)
-&gt; (Void# -&gt; r)
-&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bShuffle"><span class="hs-identifier hs-var hs-var hs-var">Shuffle</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447639"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447638"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447637"><span class="hs-identifier hs-type">v1_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447636"><span class="hs-identifier hs-type">v2_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447635"><span class="hs-identifier hs-type">mask_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1666"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.shuffle&quot;</span></span><span>
</span><span id="line-1667"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447639"><span class="annot"><a href="#local-6989586621679447639"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1668"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447638"><span class="annot"><a href="#local-6989586621679447638"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1669"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447637"><span class="annot"><a href="#local-6989586621679447637"><span class="hs-identifier hs-var">v1_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679447636"><span class="annot"><a href="#local-6989586621679447636"><span class="hs-identifier hs-var">v2_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1670"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1671"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1672"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalShuffleOpAttributes"><span class="hs-identifier hs-type">InternalShuffleOpAttributes</span></a></span><span> </span><span id="local-6989586621679447635"><span class="annot"><a href="#local-6989586621679447635"><span class="hs-identifier hs-var">mask_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1673"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1674"></span><span>
</span><span id="line-1675"></span><span class="hs-comment">-- | A builder for @vector.shuffle@.</span><span>
</span><span id="line-1676"></span><span id="local-6989586621679447634"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#shuffle"><span class="hs-identifier hs-type">shuffle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447634"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447634"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1677"></span><span id="shuffle"><span class="annot"><span class="annottext">shuffle :: Type -&gt; Value -&gt; Value -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#shuffle"><span class="hs-identifier hs-var hs-var">shuffle</span></a></span></span><span> </span><span id="local-6989586621679447632"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447632"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447631"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447631"><span class="hs-identifier hs-var">v1_</span></a></span></span><span> </span><span id="local-6989586621679447630"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447630"><span class="hs-identifier hs-var">v2_</span></a></span></span><span> </span><span id="local-6989586621679447629"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447629"><span class="hs-identifier hs-var">mask_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1678"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1679"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.shuffle&quot;</span></span><span>
</span><span id="line-1680"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1681"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447632"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1682"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447631"><span class="hs-identifier hs-var">v1_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447630"><span class="hs-identifier hs-var">v2_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1683"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1684"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1685"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalShuffleOpAttributes"><span class="hs-identifier hs-var">InternalShuffleOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447629"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1686"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="hs-comment">-- * splat</span><span>
</span><span id="line-1689"></span><span class="hs-comment">-- $splat</span><span>
</span><span id="line-1690"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1691"></span><span class="hs-comment">-- Broadcast the operand to all elements of the result vector. The operand is</span><span>
</span><span id="line-1692"></span><span class="hs-comment">-- required to be of integer/index/float type.</span><span>
</span><span id="line-1693"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1694"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1695"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1696"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1697"></span><span class="hs-comment">-- %s = arith.constant 10.1 : f32</span><span>
</span><span id="line-1698"></span><span class="hs-comment">-- %t = vector.splat %s : vector\&lt;8x16xi32&gt;</span><span>
</span><span id="line-1699"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1700"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1701"></span><span>
</span><span id="line-1702"></span><span class="hs-comment">-- | A pattern for @vector.splat@.</span><span>
</span><span id="line-1703"></span><span id="local-6989586621679447628"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Splat"><span class="hs-identifier hs-type">Splat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447628"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447628"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-1704"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bSplat"><span id="%24mSplat"><span id="Splat"><span class="annot"><span class="annottext">$bSplat :: Location -&gt; Type -&gt; operand -&gt; AbstractOperation operand
$mSplat :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bSplat"><span class="hs-identifier hs-var hs-var hs-var">Splat</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447624"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447623"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447622"><span class="hs-identifier hs-type">input_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1705"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.splat&quot;</span></span><span>
</span><span id="line-1706"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447624"><span class="annot"><a href="#local-6989586621679447624"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-1707"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447623"><span class="annot"><a href="#local-6989586621679447623"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1708"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447622"><span class="annot"><a href="#local-6989586621679447622"><span class="hs-identifier hs-var">input_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-1709"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1710"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1711"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span class="hs-comment">-- | A builder for @vector.splat@.</span><span>
</span><span id="line-1715"></span><span id="local-6989586621679447621"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#splat"><span class="hs-identifier hs-type">splat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1716"></span><span id="splat"><span class="annot"><span class="annottext">splat :: Type -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#splat"><span class="hs-identifier hs-var hs-var">splat</span></a></span></span><span> </span><span id="local-6989586621679447619"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447619"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447618"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447618"><span class="hs-identifier hs-var">input_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1717"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1718"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.splat&quot;</span></span><span>
</span><span id="line-1719"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1720"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447619"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1721"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447618"><span class="hs-identifier hs-var">input_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1722"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1723"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1724"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>
</span><span id="line-1727"></span><span class="hs-comment">-- * store</span><span>
</span><span id="line-1728"></span><span class="hs-comment">-- $store</span><span>
</span><span id="line-1729"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1730"></span><span class="hs-comment">-- The \'vector.store\' operation writes an n-D vector to an n-D slice of memory.</span><span>
</span><span id="line-1731"></span><span class="hs-comment">-- It takes the vector value to be stored, a \'base\' memref and an index for</span><span>
</span><span id="line-1732"></span><span class="hs-comment">-- each memref dimension. The \'base\' memref and indices determine the start</span><span>
</span><span id="line-1733"></span><span class="hs-comment">-- memory address from which to write. Each index provides an offset for each</span><span>
</span><span id="line-1734"></span><span class="hs-comment">-- memref dimension based on the element type of the memref. The shape of the</span><span>
</span><span id="line-1735"></span><span class="hs-comment">-- vector value to store determines the shape of the slice written from the</span><span>
</span><span id="line-1736"></span><span class="hs-comment">-- start memory address. The elements along each dimension of the slice are</span><span>
</span><span id="line-1737"></span><span class="hs-comment">-- strided by the memref strides. Only unit strides are allowed along the most</span><span>
</span><span id="line-1738"></span><span class="hs-comment">-- minor memref dimension. These constraints guarantee that elements written</span><span>
</span><span id="line-1739"></span><span class="hs-comment">-- along the first dimension of the slice are contiguous in memory.</span><span>
</span><span id="line-1740"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1741"></span><span class="hs-comment">-- The memref element type can be a scalar or a vector type. If the memref</span><span>
</span><span id="line-1742"></span><span class="hs-comment">-- element type is a scalar, it should match the element type of the value</span><span>
</span><span id="line-1743"></span><span class="hs-comment">-- to store. If the memref element type is vector, it should match the type</span><span>
</span><span id="line-1744"></span><span class="hs-comment">-- of the value to store.</span><span>
</span><span id="line-1745"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1746"></span><span class="hs-comment">-- Example 1: 1-D vector store on a scalar memref.</span><span>
</span><span id="line-1747"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1748"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%i, %j] : memref\&lt;200x100xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1749"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1751"></span><span class="hs-comment">-- Example 2: 1-D vector store on a vector memref.</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1753"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%i, %j] : memref\&lt;200x100xvector\&lt;8xf32&gt;&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1754"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1755"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1756"></span><span class="hs-comment">-- Example 3:  2-D vector store on a scalar memref.</span><span>
</span><span id="line-1757"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1758"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%i, %j] : memref\&lt;200x100xf32&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1759"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1760"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1761"></span><span class="hs-comment">-- Example 4:  2-D vector store on a vector memref.</span><span>
</span><span id="line-1762"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1763"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%i, %j] : memref\&lt;200x100xvector\&lt;4x8xf32&gt;&gt;, vector\&lt;4x8xf32&gt;</span><span>
</span><span id="line-1764"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1765"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1766"></span><span class="hs-comment">-- Representation-wise, the \'vector.store\' operation permits out-of-bounds</span><span>
</span><span id="line-1767"></span><span class="hs-comment">-- writes. Support and implementation of out-of-bounds vector stores are</span><span>
</span><span id="line-1768"></span><span class="hs-comment">-- target-specific. No assumptions should be made on the memory written out of</span><span>
</span><span id="line-1769"></span><span class="hs-comment">-- bounds. Not all targets may support out-of-bounds vector stores.</span><span>
</span><span id="line-1770"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1771"></span><span class="hs-comment">-- Example 5:  Potential out-of-bounds vector store.</span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1773"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%index] : memref\&lt;?xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1774"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1775"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1776"></span><span class="hs-comment">-- Example 6:  Explicit out-of-bounds vector store.</span><span>
</span><span id="line-1777"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1778"></span><span class="hs-comment">-- vector.store %valueToStore, %memref[%c0] : memref\&lt;7xf32&gt;, vector\&lt;8xf32&gt;</span><span>
</span><span id="line-1779"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1780"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1781"></span><span>
</span><span id="line-1782"></span><span class="hs-comment">-- | A builder for @vector.store@.</span><span>
</span><span id="line-1783"></span><span id="local-6989586621679447617"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#store"><span class="hs-identifier hs-type">store</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1784"></span><span id="store"><span class="annot"><span class="annottext">store :: Value -&gt; Value -&gt; [Value] -&gt; m ()
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#store"><span class="hs-identifier hs-var hs-var">store</span></a></span></span><span>  </span><span id="local-6989586621679447615"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447615"><span class="hs-identifier hs-var">valueToStore_</span></a></span></span><span> </span><span id="local-6989586621679447614"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447614"><span class="hs-identifier hs-var">base_</span></a></span></span><span> </span><span id="local-6989586621679447613"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447613"><span class="hs-identifier hs-var">indices_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1785"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1786"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.store&quot;</span></span><span>
</span><span id="line-1787"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1788"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1789"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447615"><span class="hs-identifier hs-var">valueToStore_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447614"><span class="hs-identifier hs-var">base_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447613"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1790"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1791"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1792"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1793"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1794"></span><span>
</span><span id="line-1795"></span><span class="hs-comment">-- * transfer_read</span><span>
</span><span id="line-1796"></span><span class="hs-comment">-- $transfer_read</span><span>
</span><span id="line-1797"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1798"></span><span class="hs-comment">-- The @vector.transfer_read@ op performs a read from a slice within a</span><span>
</span><span id="line-1799"></span><span class="hs-comment">-- MemRef or a Ranked</span><span>
</span><span id="line-1800"></span><span class="hs-comment">-- Tensor supplied as its first operand</span><span>
</span><span id="line-1801"></span><span class="hs-comment">-- into a vector of the same base elemental type.</span><span>
</span><span id="line-1802"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1803"></span><span class="hs-comment">-- A memref/tensor operand with vector element type, must have its vector</span><span>
</span><span id="line-1804"></span><span class="hs-comment">-- element type match a suffix (shape and element type) of the vector (e.g.</span><span>
</span><span id="line-1805"></span><span class="hs-comment">-- memref\&lt;3x2x6x4x3xf32&gt;, vector\&lt;1x1x4x3xf32&gt;).</span><span>
</span><span id="line-1806"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1807"></span><span class="hs-comment">-- The slice is further defined by a full-rank index within the MemRef/Tensor,</span><span>
</span><span id="line-1808"></span><span class="hs-comment">-- supplied as the operands @[1 .. 1 + rank(memref/tensor))@ that defines the</span><span>
</span><span id="line-1809"></span><span class="hs-comment">-- starting point of the transfer (e.g. @%A[%i0, %i1, %i2]@).</span><span>
</span><span id="line-1810"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1811"></span><span class="hs-comment">-- The permutation_map attribute is an</span><span>
</span><span id="line-1812"></span><span class="hs-comment">-- affine-map which specifies the transposition on the</span><span>
</span><span id="line-1813"></span><span class="hs-comment">-- slice to match the vector shape. The permutation map may be implicit and</span><span>
</span><span id="line-1814"></span><span class="hs-comment">-- omitted from parsing and printing if it is the canonical minor identity map</span><span>
</span><span id="line-1815"></span><span class="hs-comment">-- (i.e. if it does not permute or broadcast any dimension).</span><span>
</span><span id="line-1816"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1817"></span><span class="hs-comment">-- The size of the slice is specified by the size of the vector, given as the</span><span>
</span><span id="line-1818"></span><span class="hs-comment">-- return type.</span><span>
</span><span id="line-1819"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1820"></span><span class="hs-comment">-- An SSA value @padding@ of the same elemental type as the MemRef/Tensor is</span><span>
</span><span id="line-1821"></span><span class="hs-comment">-- provided to specify a fallback value in the case of out-of-bounds accesses</span><span>
</span><span id="line-1822"></span><span class="hs-comment">-- and/or masking.</span><span>
</span><span id="line-1823"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1824"></span><span class="hs-comment">-- An optional SSA value @mask@ of the same shape as the vector type may be</span><span>
</span><span id="line-1825"></span><span class="hs-comment">-- specified to mask out elements. Such elements will be replaces with</span><span>
</span><span id="line-1826"></span><span class="hs-comment">-- @padding@. Elements whose corresponding mask element is @0@ are masked out.</span><span>
</span><span id="line-1827"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1828"></span><span class="hs-comment">-- An optional boolean array attribute @in_bounds@ specifies for every vector</span><span>
</span><span id="line-1829"></span><span class="hs-comment">-- dimension if the transfer is guaranteed to be within the source bounds.</span><span>
</span><span id="line-1830"></span><span class="hs-comment">-- While the starting point of the transfer has to be in-bounds, accesses may</span><span>
</span><span id="line-1831"></span><span class="hs-comment">-- run out-of-bounds as indices increase. Broadcast dimensions must always be</span><span>
</span><span id="line-1832"></span><span class="hs-comment">-- in-bounds. If specified, the @in_bounds@ array length has to be equal to the</span><span>
</span><span id="line-1833"></span><span class="hs-comment">-- vector rank. In absence of the attribute, accesses along all dimensions</span><span>
</span><span id="line-1834"></span><span class="hs-comment">-- (except for broadcasts) may run out-of-bounds. A @vector.transfer_read@ can</span><span>
</span><span id="line-1835"></span><span class="hs-comment">-- be lowered to a simple load if all dimensions are specified to be within</span><span>
</span><span id="line-1836"></span><span class="hs-comment">-- bounds and no @mask@ was specified.</span><span>
</span><span id="line-1837"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1838"></span><span class="hs-comment">-- This operation is called \'read\' by opposition to \'load\' because the</span><span>
</span><span id="line-1839"></span><span class="hs-comment">-- super-vector granularity is generally not representable with a single</span><span>
</span><span id="line-1840"></span><span class="hs-comment">-- hardware register. A @vector.transfer_read@ is thus a mid-level abstraction</span><span>
</span><span id="line-1841"></span><span class="hs-comment">-- that supports super-vectorization with non-effecting padding for full-tile</span><span>
</span><span id="line-1842"></span><span class="hs-comment">-- only operations.</span><span>
</span><span id="line-1843"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1844"></span><span class="hs-comment">-- More precisely, let\'s dive deeper into the permutation_map for the following</span><span>
</span><span id="line-1845"></span><span class="hs-comment">-- MLIR:</span><span>
</span><span id="line-1846"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1847"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1848"></span><span class="hs-comment">-- vector.transfer_read %A[%expr1, %expr2, %expr3, %expr4]</span><span>
</span><span id="line-1849"></span><span class="hs-comment">--   { permutation_map : (d0,d1,d2,d3) -&gt; (d2,0,d0) } :</span><span>
</span><span id="line-1850"></span><span class="hs-comment">--   memref\&lt;?x?x?x?xf32&gt;, vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1851"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1852"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1853"></span><span class="hs-comment">-- This operation always reads a slice starting at @%A[%expr1, %expr2, %expr3,</span><span>
</span><span id="line-1854"></span><span class="hs-comment">-- %expr4]@. The size of the slice is 3 along d2 and 5 along d0, so the slice</span><span>
</span><span id="line-1855"></span><span class="hs-comment">-- is: @%A[%expr1 : %expr1 + 5, %expr2, %expr3:%expr3 + 3, %expr4]@</span><span>
</span><span id="line-1856"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1857"></span><span class="hs-comment">-- That slice needs to be read into a @vector\&lt;3x4x5xf32&gt;@. Since the</span><span>
</span><span id="line-1858"></span><span class="hs-comment">-- permutation map is not full rank, there must be a broadcast along vector</span><span>
</span><span id="line-1859"></span><span class="hs-comment">-- dimension @1@.</span><span>
</span><span id="line-1860"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1861"></span><span class="hs-comment">-- A notional lowering of vector.transfer_read could generate code resembling:</span><span>
</span><span id="line-1862"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1863"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1864"></span><span class="hs-comment">-- // %expr1, %expr2, %expr3, %expr4 defined before this point</span><span>
</span><span id="line-1865"></span><span class="hs-comment">-- %tmp = alloc() : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1866"></span><span class="hs-comment">-- %view_in_tmp = \&quot;element_type_cast\&quot;(%tmp) : memref\&lt;1xvector\&lt;3x4x5xf32&gt;&gt;</span><span>
</span><span id="line-1867"></span><span class="hs-comment">-- for %i = 0 to 3 {</span><span>
</span><span id="line-1868"></span><span class="hs-comment">--   affine.for %j = 0 to 4 {</span><span>
</span><span id="line-1869"></span><span class="hs-comment">--     affine.for %k = 0 to 5 {</span><span>
</span><span id="line-1870"></span><span class="hs-comment">--       %a = load %A[%expr1 + %k, %expr2, %expr3 + %i, %expr4] :</span><span>
</span><span id="line-1871"></span><span class="hs-comment">--         memref\&lt;?x?x?x?xf32&gt;</span><span>
</span><span id="line-1872"></span><span class="hs-comment">--       store %tmp[%i, %j, %k] : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1873"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-1874"></span><span class="hs-comment">-- %c0 = arith.constant 0 : index</span><span>
</span><span id="line-1875"></span><span class="hs-comment">-- %vec = load %view_in_tmp[%c0] : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1876"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1877"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1878"></span><span class="hs-comment">-- On a GPU one could then map @i@, @j@, @k@ to blocks and threads. Notice that</span><span>
</span><span id="line-1879"></span><span class="hs-comment">-- the temporary storage footprint is @3 * 5@ values but @3 * 4 * 5@ values are</span><span>
</span><span id="line-1880"></span><span class="hs-comment">-- actually transferred between @%A@ and @%tmp@.</span><span>
</span><span id="line-1881"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1882"></span><span class="hs-comment">-- Alternatively, if a notional vector broadcast operation were available, the</span><span>
</span><span id="line-1883"></span><span class="hs-comment">-- lowered code would resemble:</span><span>
</span><span id="line-1884"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1885"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1886"></span><span class="hs-comment">-- // %expr1, %expr2, %expr3, %expr4 defined before this point</span><span>
</span><span id="line-1887"></span><span class="hs-comment">-- %tmp = alloc() : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1888"></span><span class="hs-comment">-- %view_in_tmp = \&quot;element_type_cast\&quot;(%tmp) : memref\&lt;1xvector\&lt;3x4x5xf32&gt;&gt;</span><span>
</span><span id="line-1889"></span><span class="hs-comment">-- for %i = 0 to 3 {</span><span>
</span><span id="line-1890"></span><span class="hs-comment">--   affine.for %k = 0 to 5 {</span><span>
</span><span id="line-1891"></span><span class="hs-comment">--     %a = load %A[%expr1 + %k, %expr2, %expr3 + %i, %expr4] :</span><span>
</span><span id="line-1892"></span><span class="hs-comment">--       memref\&lt;?x?x?x?xf32&gt;</span><span>
</span><span id="line-1893"></span><span class="hs-comment">--     store %tmp[%i, 0, %k] : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1894"></span><span class="hs-comment">-- }}</span><span>
</span><span id="line-1895"></span><span class="hs-comment">-- %c0 = arith.constant 0 : index</span><span>
</span><span id="line-1896"></span><span class="hs-comment">-- %tmpvec = load %view_in_tmp[%c0] : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1897"></span><span class="hs-comment">-- %vec = broadcast %tmpvec, 1 : vector\&lt;3x4x5xf32&gt;</span><span>
</span><span id="line-1898"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1899"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1900"></span><span class="hs-comment">-- where @broadcast@ broadcasts from element 0 to all others along the</span><span>
</span><span id="line-1901"></span><span class="hs-comment">-- specified dimension. This time, the temporary storage footprint is @3 * 5@</span><span>
</span><span id="line-1902"></span><span class="hs-comment">-- values which is the same amount of data as the @3 * 5@ values transferred.</span><span>
</span><span id="line-1903"></span><span class="hs-comment">-- An additional @1@ broadcast is required. On a GPU this broadcast could be</span><span>
</span><span id="line-1904"></span><span class="hs-comment">-- implemented using a warp-shuffle if loop @j@ were mapped to @threadIdx.x@.</span><span>
</span><span id="line-1905"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1906"></span><span class="hs-comment">-- Syntax</span><span>
</span><span id="line-1907"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1908"></span><span class="hs-comment">-- operation ::= ssa-id @=@ @vector.transfer_read@ ssa-use-list</span><span>
</span><span id="line-1909"></span><span class="hs-comment">--   @{@ attribute-entry @} :@ memref-type @,@ vector-type</span><span>
</span><span id="line-1910"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1911"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1912"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-1913"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1914"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1915"></span><span class="hs-comment">-- // Read the slice @%A[%i0, %i1:%i1+256, %i2:%i2+32]@ into vector\&lt;32x256xf32&gt;</span><span>
</span><span id="line-1916"></span><span class="hs-comment">-- // and pad with %f0 to handle the boundary case:</span><span>
</span><span id="line-1917"></span><span class="hs-comment">-- %f0 = arith.constant 0.0f : f32</span><span>
</span><span id="line-1918"></span><span class="hs-comment">-- for %i0 = 0 to %0 {</span><span>
</span><span id="line-1919"></span><span class="hs-comment">--   affine.for %i1 = 0 to %1 step 256 {</span><span>
</span><span id="line-1920"></span><span class="hs-comment">--     affine.for %i2 = 0 to %2 step 32 {</span><span>
</span><span id="line-1921"></span><span class="hs-comment">--       %v = vector.transfer_read %A[%i0, %i1, %i2], (%f0)</span><span>
</span><span id="line-1922"></span><span class="hs-comment">--            {permutation_map: (d0, d1, d2) -&gt; (d2, d1)} :</span><span>
</span><span id="line-1923"></span><span class="hs-comment">--            memref\&lt;?x?x?xf32&gt;, vector\&lt;32x256xf32&gt;</span><span>
</span><span id="line-1924"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-1925"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1926"></span><span class="hs-comment">-- // Read the slice @%A[%i0, %i1]@ (i.e. the element @%A[%i0, %i1]@) into</span><span>
</span><span id="line-1927"></span><span class="hs-comment">-- // vector\&lt;128xf32&gt;. The underlying implementation will require a 1-D vector</span><span>
</span><span id="line-1928"></span><span class="hs-comment">-- // broadcast:</span><span>
</span><span id="line-1929"></span><span class="hs-comment">-- for %i0 = 0 to %0 {</span><span>
</span><span id="line-1930"></span><span class="hs-comment">--   affine.for %i1 = 0 to %1 {</span><span>
</span><span id="line-1931"></span><span class="hs-comment">--     %3 = vector.transfer_read %A[%i0, %i1]</span><span>
</span><span id="line-1932"></span><span class="hs-comment">--          {permutation_map: (d0, d1) -&gt; (0)} :</span><span>
</span><span id="line-1933"></span><span class="hs-comment">--          memref\&lt;?x?xf32&gt;, vector\&lt;128xf32&gt;</span><span>
</span><span id="line-1934"></span><span class="hs-comment">--   }</span><span>
</span><span id="line-1935"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1937"></span><span class="hs-comment">-- // Read from a memref with vector element type.</span><span>
</span><span id="line-1938"></span><span class="hs-comment">-- %4 = vector.transfer_read %arg1[%c3, %c3], %vf0</span><span>
</span><span id="line-1939"></span><span class="hs-comment">--   {permutation_map = (d0, d1)-&gt;(d0, d1)}</span><span>
</span><span id="line-1940"></span><span class="hs-comment">--     : memref\&lt;?x?xvector\&lt;4x3xf32&gt;&gt;, vector\&lt;1x1x4x3xf32&gt;</span><span>
</span><span id="line-1941"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1942"></span><span class="hs-comment">-- // Read from a tensor with vector element type.</span><span>
</span><span id="line-1943"></span><span class="hs-comment">-- %4 = vector.transfer_read %arg1[%c3, %c3], %vf0</span><span>
</span><span id="line-1944"></span><span class="hs-comment">--   {permutation_map = (d0, d1)-&gt;(d0, d1)}</span><span>
</span><span id="line-1945"></span><span class="hs-comment">--     : tensor\&lt;?x?xvector\&lt;4x3xf32&gt;&gt;, vector\&lt;1x1x4x3xf32&gt;</span><span>
</span><span id="line-1946"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1947"></span><span class="hs-comment">-- // Special encoding for 0-d transfer with 0-d tensor/memref, vector shape</span><span>
</span><span id="line-1948"></span><span class="hs-comment">-- // {1} and permutation_map () -&gt; (0).</span><span>
</span><span id="line-1949"></span><span class="hs-comment">-- %0 = vector.transfer_read %arg0[], %f0 {permutation_map = affine_map\&lt;()-&gt;(0)&gt;} :</span><span>
</span><span id="line-1950"></span><span class="hs-comment">--   tensor\&lt;f32&gt;, vector\&lt;1xf32&gt;</span><span>
</span><span id="line-1951"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1952"></span><span class="hs-comment">--   </span><span>
</span><span id="line-1953"></span><span>
</span><span id="line-1954"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferReadOpAttributes"><span class="hs-identifier hs-type">InternalTransferReadOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Affine.html#Map"><span class="hs-identifier hs-type">Affine.Map</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-1955"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalTransferReadOpAttributes"><span id="%24mInternalTransferReadOpAttributes"><span id="InternalTransferReadOpAttributes"><span class="annot"><span class="annottext">$bInternalTransferReadOpAttributes :: Map -&gt; Map Name Attribute
$mInternalTransferReadOpAttributes :: forall r. Map Name Attribute -&gt; (Map -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalTransferReadOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalTransferReadOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447609"><span class="hs-identifier hs-type">permutation_map_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447608"><span class="annot"><a href="#local-6989586621679447608"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;permutation_map&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#AffineMapAttr"><span class="hs-identifier hs-type">AffineMapAttr</span></a></span><span> </span><span id="local-6989586621679447609"><span class="annot"><a href="#local-6989586621679447609"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1956"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferReadOpAttributes"><span class="hs-identifier hs-var">InternalTransferReadOpAttributes</span></a></span><span> </span><span id="local-6989586621679447606"><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447606"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;permutation_map&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map -&gt; Attribute
</span><a href="MLIR.AST.html#AffineMapAttr"><span class="hs-identifier hs-var">AffineMapAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447606"><span class="hs-identifier hs-var">permutation_map_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1957"></span><span>
</span><span id="line-1958"></span><span class="hs-comment">-- | A builder for @vector.transfer_read@.</span><span>
</span><span id="line-1959"></span><span id="local-6989586621679447605"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#transfer_read"><span class="hs-identifier hs-type">transfer_read</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Affine.html#Map"><span class="hs-identifier hs-type">Affine.Map</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-1960"></span><span id="transfer_read"><span class="annot"><span class="annottext">transfer_read :: Type -&gt; Value -&gt; [Value] -&gt; Value -&gt; Maybe Value -&gt; Map -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#transfer_read"><span class="hs-identifier hs-var hs-var">transfer_read</span></a></span></span><span> </span><span id="local-6989586621679447603"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447603"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447602"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447602"><span class="hs-identifier hs-var">source_</span></a></span></span><span> </span><span id="local-6989586621679447601"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447601"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447600"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447600"><span class="hs-identifier hs-var">padding_</span></a></span></span><span> </span><span id="local-6989586621679447599"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447599"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447598"><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447598"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1961"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-1962"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.transfer_read&quot;</span></span><span>
</span><span id="line-1963"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-1964"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447603"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1965"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447602"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447601"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447600"><span class="hs-identifier hs-var">padding_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; [Name]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">Data.Maybe.maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447599"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1966"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1967"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1968"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferReadOpAttributes"><span class="hs-identifier hs-var">InternalTransferReadOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447598"><span class="hs-identifier hs-var">permutation_map_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1969"></span><span>              </span><span class="annot"><span class="annottext">Map Name Attribute -&gt; Map Name Attribute -&gt; Map Name Attribute
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Attribute -&gt; Map Name Attribute
</span><a href="MLIR.AST.html#namedAttribute"><span class="hs-identifier hs-var">AST.namedAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;operand_segment_sizes&quot;</span></span><span>
</span><span id="line-1970"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DenseElements -&gt; Attribute
</span><a href="MLIR.AST.html#DenseElementsAttr"><span class="hs-identifier hs-var">DenseElementsAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Type -&gt; Type
</span><a href="MLIR.AST.html#VectorType"><span class="hs-identifier hs-var">VectorType</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Unsigned"><span class="hs-identifier hs-var">Unsigned</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DenseElements -&gt; Attribute) -&gt; DenseElements -&gt; Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1971"></span><span>                      </span><span class="annot"><span class="annottext">IStorableArray Int Word32 -&gt; DenseElements
forall i.
(Show i, Ix i) =&gt;
IStorableArray i Word32 -&gt; DenseElements
</span><a href="MLIR.AST.html#DenseUInt32"><span class="hs-identifier hs-var">DenseUInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(IStorableArray Int Word32 -&gt; DenseElements)
-&gt; IStorableArray Int Word32 -&gt; DenseElements
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word32] -&gt; IStorableArray Int Word32
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><span class="hs-identifier hs-var">IArray.listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word32] -&gt; IStorableArray Int Word32)
-&gt; [Word32] -&gt; IStorableArray Int Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">Prelude.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; [Int] -&gt; [Word32]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447601"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447599"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1972"></span><span>
</span><span id="line-1973"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1974"></span><span>
</span><span id="line-1975"></span><span class="hs-comment">-- * transfer_write</span><span>
</span><span id="line-1976"></span><span class="hs-comment">-- $transfer_write</span><span>
</span><span id="line-1977"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1978"></span><span class="hs-comment">-- The @vector.transfer_write@ op performs a write from a</span><span>
</span><span id="line-1979"></span><span class="hs-comment">-- vector, supplied as its first operand, into a</span><span>
</span><span id="line-1980"></span><span class="hs-comment">-- slice within a MemRef or a Ranked</span><span>
</span><span id="line-1981"></span><span class="hs-comment">-- Tensor of the same base elemental type,</span><span>
</span><span id="line-1982"></span><span class="hs-comment">-- supplied as its second operand.</span><span>
</span><span id="line-1983"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1984"></span><span class="hs-comment">-- A vector memref/tensor operand must have its vector element type match a</span><span>
</span><span id="line-1985"></span><span class="hs-comment">-- suffix (shape and element type) of the vector (e.g. memref\&lt;3x2x6x4x3xf32&gt;,</span><span>
</span><span id="line-1986"></span><span class="hs-comment">-- vector\&lt;1x1x4x3xf32&gt;). If the operand is a tensor, the operation returns a</span><span>
</span><span id="line-1987"></span><span class="hs-comment">-- new tensor of the same type.</span><span>
</span><span id="line-1988"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1989"></span><span class="hs-comment">-- The slice is further defined by a full-rank index within the MemRef/Tensor,</span><span>
</span><span id="line-1990"></span><span class="hs-comment">-- supplied as the operands @[2 .. 2 + rank(memref/tensor))@ that defines the</span><span>
</span><span id="line-1991"></span><span class="hs-comment">-- starting point of the transfer (e.g. @%A[%i0, %i1, %i2, %i3]@).</span><span>
</span><span id="line-1992"></span><span class="hs-comment">-- </span><span>
</span><span id="line-1993"></span><span class="hs-comment">-- The permutation_map attribute is an</span><span>
</span><span id="line-1994"></span><span class="hs-comment">-- affine-map which specifies the transposition on the</span><span>
</span><span id="line-1995"></span><span class="hs-comment">-- slice to match the vector shape. The permutation map may be implicit and</span><span>
</span><span id="line-1996"></span><span class="hs-comment">-- omitted from parsing and printing if it is the canonical minor identity map</span><span>
</span><span id="line-1997"></span><span class="hs-comment">-- (i.e. if it does not permute any dimension). In contrast to @transfer_read@,</span><span>
</span><span id="line-1998"></span><span class="hs-comment">-- write ops cannot have broadcast dimensions.</span><span>
</span><span id="line-1999"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2000"></span><span class="hs-comment">-- The size of the slice is specified by the size of the vector.</span><span>
</span><span id="line-2001"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2002"></span><span class="hs-comment">-- An optional SSA value @mask@ of the same shape as the vector type may be</span><span>
</span><span id="line-2003"></span><span class="hs-comment">-- specified to mask out elements. Elements whose corresponding mask element</span><span>
</span><span id="line-2004"></span><span class="hs-comment">-- is @0@ are masked out.</span><span>
</span><span id="line-2005"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2006"></span><span class="hs-comment">-- An optional boolean array attribute @in_bounds@ specifies for every vector</span><span>
</span><span id="line-2007"></span><span class="hs-comment">-- dimension if the transfer is guaranteed to be within the source bounds.</span><span>
</span><span id="line-2008"></span><span class="hs-comment">-- While the starting point of the transfer has to be in-bounds, accesses may</span><span>
</span><span id="line-2009"></span><span class="hs-comment">-- run out-of-bounds as indices increase. If specified, the @in_bounds@ array</span><span>
</span><span id="line-2010"></span><span class="hs-comment">-- length has to be equal to the vector rank. In absence of the attribute,</span><span>
</span><span id="line-2011"></span><span class="hs-comment">-- accesses along all dimensions may run out-of-bounds. A</span><span>
</span><span id="line-2012"></span><span class="hs-comment">-- @vector.transfer_write@ can be lowered to a simple store if all dimensions</span><span>
</span><span id="line-2013"></span><span class="hs-comment">-- are specified to be within bounds and no @mask@ was specified.</span><span>
</span><span id="line-2014"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2015"></span><span class="hs-comment">-- This operation is called \'write\' by opposition to \'store\' because the</span><span>
</span><span id="line-2016"></span><span class="hs-comment">-- super-vector granularity is generally not representable with a single</span><span>
</span><span id="line-2017"></span><span class="hs-comment">-- hardware register. A @vector.transfer_write@ is thus a</span><span>
</span><span id="line-2018"></span><span class="hs-comment">-- mid-level abstraction that supports super-vectorization with non-effecting</span><span>
</span><span id="line-2019"></span><span class="hs-comment">-- padding for full-tile-only code. It is the responsibility of</span><span>
</span><span id="line-2020"></span><span class="hs-comment">-- @vector.transfer_write@\'s implementation to ensure the memory writes are</span><span>
</span><span id="line-2021"></span><span class="hs-comment">-- valid. Different lowerings may be pertinent depending on the hardware</span><span>
</span><span id="line-2022"></span><span class="hs-comment">-- support.</span><span>
</span><span id="line-2023"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2024"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-2025"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2026"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2027"></span><span class="hs-comment">-- // write vector\&lt;16x32x64xf32&gt; into the slice</span><span>
</span><span id="line-2028"></span><span class="hs-comment">-- //   @%A[%i0, %i1:%i1+32, %i2:%i2+64, %i3:%i3+16]@:</span><span>
</span><span id="line-2029"></span><span class="hs-comment">-- for %i0 = 0 to %0 {</span><span>
</span><span id="line-2030"></span><span class="hs-comment">--   affine.for %i1 = 0 to %1 step 32 {</span><span>
</span><span id="line-2031"></span><span class="hs-comment">--     affine.for %i2 = 0 to %2 step 64 {</span><span>
</span><span id="line-2032"></span><span class="hs-comment">--       affine.for %i3 = 0 to %3 step 16 {</span><span>
</span><span id="line-2033"></span><span class="hs-comment">--         %val = @ssa-value@ : vector\&lt;16x32x64xf32&gt;</span><span>
</span><span id="line-2034"></span><span class="hs-comment">--         vector.transfer_write %val, %A[%i0, %i1, %i2, %i3]</span><span>
</span><span id="line-2035"></span><span class="hs-comment">--           {permutation_map: (d0, d1, d2, d3) -&gt; (d3, d1, d2)} :</span><span>
</span><span id="line-2036"></span><span class="hs-comment">--           vector\&lt;16x32x64xf32&gt;, memref\&lt;?x?x?x?xf32&gt;</span><span>
</span><span id="line-2037"></span><span class="hs-comment">-- }}}}</span><span>
</span><span id="line-2038"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2039"></span><span class="hs-comment">-- // write to a memref with vector element type.</span><span>
</span><span id="line-2040"></span><span class="hs-comment">-- vector.transfer_write %4, %arg1[%c3, %c3]</span><span>
</span><span id="line-2041"></span><span class="hs-comment">--   {permutation_map = (d0, d1)-&gt;(d0, d1)}</span><span>
</span><span id="line-2042"></span><span class="hs-comment">--     : vector\&lt;1x1x4x3xf32&gt;, memref\&lt;?x?xvector\&lt;4x3xf32&gt;&gt;</span><span>
</span><span id="line-2043"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2044"></span><span class="hs-comment">-- // return a tensor where the vector is inserted into the source tensor.</span><span>
</span><span id="line-2045"></span><span class="hs-comment">-- %5 = vector.transfer_write %4, %arg1[%c3, %c3]</span><span>
</span><span id="line-2046"></span><span class="hs-comment">--   {permutation_map = (d0, d1)-&gt;(d0, d1)}</span><span>
</span><span id="line-2047"></span><span class="hs-comment">--     : vector\&lt;1x1x4x3xf32&gt;, tensor\&lt;?x?xvector\&lt;4x3xf32&gt;&gt;</span><span>
</span><span id="line-2048"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2049"></span><span class="hs-comment">-- // Special encoding for 0-d transfer with 0-d tensor/memref, vector shape</span><span>
</span><span id="line-2050"></span><span class="hs-comment">-- // {1} and permutation_map () -&gt; (0).</span><span>
</span><span id="line-2051"></span><span class="hs-comment">-- %1 = vector.transfer_write %0, %arg0[] {permutation_map = affine_map\&lt;()-&gt;(0)&gt;} :</span><span>
</span><span id="line-2052"></span><span class="hs-comment">--   vector\&lt;1xf32&gt;, tensor\&lt;f32&gt;</span><span>
</span><span id="line-2053"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2054"></span><span class="hs-comment">--   </span><span>
</span><span id="line-2055"></span><span>
</span><span id="line-2056"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferWriteOpAttributes"><span class="hs-identifier hs-type">InternalTransferWriteOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Affine.html#Map"><span class="hs-identifier hs-type">Affine.Map</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-2057"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalTransferWriteOpAttributes"><span id="%24mInternalTransferWriteOpAttributes"><span id="InternalTransferWriteOpAttributes"><span class="annot"><span class="annottext">$bInternalTransferWriteOpAttributes :: Map -&gt; Map Name Attribute
$mInternalTransferWriteOpAttributes :: forall r. Map Name Attribute -&gt; (Map -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalTransferWriteOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalTransferWriteOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447594"><span class="hs-identifier hs-type">permutation_map_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447593"><span class="annot"><a href="#local-6989586621679447593"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;permutation_map&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447593"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#AffineMapAttr"><span class="hs-identifier hs-type">AffineMapAttr</span></a></span><span> </span><span id="local-6989586621679447594"><span class="annot"><a href="#local-6989586621679447594"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2058"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferWriteOpAttributes"><span class="hs-identifier hs-var">InternalTransferWriteOpAttributes</span></a></span><span> </span><span id="local-6989586621679447592"><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447592"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;permutation_map&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map -&gt; Attribute
</span><a href="MLIR.AST.html#AffineMapAttr"><span class="hs-identifier hs-var">AffineMapAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447592"><span class="hs-identifier hs-var">permutation_map_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2059"></span><span>
</span><span id="line-2060"></span><span class="hs-comment">-- | A builder for @vector.transfer_write@.</span><span>
</span><span id="line-2061"></span><span id="local-6989586621679447591"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#transfer_write"><span class="hs-identifier hs-type">transfer_write</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447591"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Affine.html#Map"><span class="hs-identifier hs-type">Affine.Map</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447591"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-2062"></span><span id="transfer_write"><span class="annot"><span class="annottext">transfer_write :: Maybe Type
-&gt; Value -&gt; Value -&gt; [Value] -&gt; Maybe Value -&gt; Map -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#transfer_write"><span class="hs-identifier hs-var hs-var">transfer_write</span></a></span></span><span> </span><span id="local-6989586621679447589"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679447589"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447588"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447588"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447587"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447587"><span class="hs-identifier hs-var">source_</span></a></span></span><span> </span><span id="local-6989586621679447586"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447586"><span class="hs-identifier hs-var">indices_</span></a></span></span><span> </span><span id="local-6989586621679447585"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447585"><span class="hs-identifier hs-var">mask_</span></a></span></span><span> </span><span id="local-6989586621679447584"><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447584"><span class="hs-identifier hs-var">permutation_map_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2063"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2064"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.transfer_write&quot;</span></span><span>
</span><span id="line-2065"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-2066"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type -&gt; [Type]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">Data.Maybe.maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679447589"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2067"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447588"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447587"><span class="hs-identifier hs-var">source_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447586"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; [Name]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">Data.Maybe.maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447585"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2068"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2069"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2070"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransferWriteOpAttributes"><span class="hs-identifier hs-var">InternalTransferWriteOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Map
</span><a href="#local-6989586621679447584"><span class="hs-identifier hs-var">permutation_map_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2071"></span><span>              </span><span class="annot"><span class="annottext">Map Name Attribute -&gt; Map Name Attribute -&gt; Map Name Attribute
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Attribute -&gt; Map Name Attribute
</span><a href="MLIR.AST.html#namedAttribute"><span class="hs-identifier hs-var">AST.namedAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;operand_segment_sizes&quot;</span></span><span>
</span><span id="line-2072"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; DenseElements -&gt; Attribute
</span><a href="MLIR.AST.html#DenseElementsAttr"><span class="hs-identifier hs-var">DenseElementsAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Type -&gt; Type
</span><a href="MLIR.AST.html#VectorType"><span class="hs-identifier hs-var">VectorType</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Unsigned"><span class="hs-identifier hs-var">Unsigned</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DenseElements -&gt; Attribute) -&gt; DenseElements -&gt; Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2073"></span><span>                      </span><span class="annot"><span class="annottext">IStorableArray Int Word32 -&gt; DenseElements
forall i.
(Show i, Ix i) =&gt;
IStorableArray i Word32 -&gt; DenseElements
</span><a href="MLIR.AST.html#DenseUInt32"><span class="hs-identifier hs-var">DenseUInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(IStorableArray Int Word32 -&gt; DenseElements)
-&gt; IStorableArray Int Word32 -&gt; DenseElements
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word32] -&gt; IStorableArray Int Word32
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><span class="hs-identifier hs-var">IArray.listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word32] -&gt; IStorableArray Int Word32)
-&gt; [Word32] -&gt; IStorableArray Int Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">Prelude.fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; [Int] -&gt; [Word32]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447586"><span class="hs-identifier hs-var">indices_</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Name) -&gt; Maybe Value -&gt; Maybe Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679447585"><span class="hs-identifier hs-var">mask_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2074"></span><span>
</span><span id="line-2075"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2076"></span><span>
</span><span id="line-2077"></span><span class="hs-comment">-- * transpose</span><span>
</span><span id="line-2078"></span><span class="hs-comment">-- $transpose</span><span>
</span><span id="line-2079"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2080"></span><span class="hs-comment">-- Takes a n-D vector and returns the transposed n-D vector defined by</span><span>
</span><span id="line-2081"></span><span class="hs-comment">-- the permutation of ranks in the n-sized integer array attribute.</span><span>
</span><span id="line-2082"></span><span class="hs-comment">-- In the operation</span><span>
</span><span id="line-2083"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2084"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2085"></span><span class="hs-comment">-- %1 = vector.transpose %0, [i_1, .., i_n]</span><span>
</span><span id="line-2086"></span><span class="hs-comment">--   : vector\&lt;d_1 x .. x d_n x f32&gt;</span><span>
</span><span id="line-2087"></span><span class="hs-comment">--   to vector\&lt;d_trans[0] x .. x d_trans[n-1] x f32&gt;</span><span>
</span><span id="line-2088"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2089"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2090"></span><span class="hs-comment">-- the transp array [i_1, .., i_n] must be a permutation of [0, .., n-1].</span><span>
</span><span id="line-2091"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2092"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-2093"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2094"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2095"></span><span class="hs-comment">-- %1 = vector.transpose %0, [1, 0] : vector\&lt;2x3xf32&gt; to vector\&lt;3x2xf32&gt;</span><span>
</span><span id="line-2096"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2097"></span><span class="hs-comment">--  [ [a, b, c],       [ [a, d],</span><span>
</span><span id="line-2098"></span><span class="hs-comment">--    [d, e, f] ]  -&gt;    [b, e],</span><span>
</span><span id="line-2099"></span><span class="hs-comment">--                       [c, f] ]</span><span>
</span><span id="line-2100"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2101"></span><span class="hs-comment">--   </span><span>
</span><span id="line-2102"></span><span>
</span><span id="line-2103"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransposeOpAttributes"><span class="hs-identifier hs-type">InternalTransposeOpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-2104"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalTransposeOpAttributes"><span id="%24mInternalTransposeOpAttributes"><span id="InternalTransposeOpAttributes"><span class="annot"><span class="annottext">$bInternalTransposeOpAttributes :: [Int] -&gt; Map Name Attribute
$mInternalTransposeOpAttributes :: forall r. Map Name Attribute -&gt; ([Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalTransposeOpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalTransposeOpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447580"><span class="hs-identifier hs-type">transp_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447579"><span class="annot"><a href="#local-6989586621679447579"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;transp&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447579"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-type">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span id="local-6989586621679447580"><span class="annot"><a href="#local-6989586621679447580"><span class="hs-identifier hs-var">transp_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2105"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransposeOpAttributes"><span class="hs-identifier hs-var">InternalTransposeOpAttributes</span></a></span><span> </span><span id="local-6989586621679447578"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447578"><span class="hs-identifier hs-var">transp_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;transp&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Attribute
</span><a href="MLIR.AST.PatternUtil.html#I64ArrayAttr"><span class="hs-identifier hs-var">PatternUtil.I64ArrayAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447578"><span class="hs-identifier hs-var">transp_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2106"></span><span>
</span><span id="line-2107"></span><span class="hs-comment">-- | A pattern for @vector.transpose@.</span><span>
</span><span id="line-2108"></span><span id="local-6989586621679447577"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447577"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447577"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-2109"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bTranspose"><span id="%24mTranspose"><span id="Transpose"><span class="annot"><span class="annottext">$bTranspose :: Location -&gt; Type -&gt; operand -&gt; [Int] -&gt; AbstractOperation operand
$mTranspose :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; [Int] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bTranspose"><span class="hs-identifier hs-var hs-var hs-var">Transpose</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447573"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447572"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447571"><span class="hs-identifier hs-type">vector_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447570"><span class="hs-identifier hs-type">transp_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2110"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.transpose&quot;</span></span><span>
</span><span id="line-2111"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447573"><span class="annot"><a href="#local-6989586621679447573"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-2112"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447572"><span class="annot"><a href="#local-6989586621679447572"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2113"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447571"><span class="annot"><a href="#local-6989586621679447571"><span class="hs-identifier hs-var">vector_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2114"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2115"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2116"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransposeOpAttributes"><span class="hs-identifier hs-type">InternalTransposeOpAttributes</span></a></span><span> </span><span id="local-6989586621679447570"><span class="annot"><a href="#local-6989586621679447570"><span class="hs-identifier hs-var">transp_</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2117"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-2118"></span><span>
</span><span id="line-2119"></span><span class="hs-comment">-- | A builder for @vector.transpose@.</span><span>
</span><span id="line-2120"></span><span id="local-6989586621679447569"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447569"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447569"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-2121"></span><span id="transpose"><span class="annot"><span class="annottext">transpose :: Type -&gt; Value -&gt; [Int] -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#transpose"><span class="hs-identifier hs-var hs-var">transpose</span></a></span></span><span> </span><span id="local-6989586621679447567"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447567"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447566"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447566"><span class="hs-identifier hs-var">vector_</span></a></span></span><span> </span><span id="local-6989586621679447565"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447565"><span class="hs-identifier hs-var">transp_</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2122"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2123"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.transpose&quot;</span></span><span>
</span><span id="line-2124"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-2125"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447567"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2126"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447566"><span class="hs-identifier hs-var">vector_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2127"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2128"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2129"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalTransposeOpAttributes"><span class="hs-identifier hs-var">InternalTransposeOpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679447565"><span class="hs-identifier hs-var">transp_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2130"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2131"></span><span>
</span><span id="line-2132"></span><span class="hs-comment">-- * type_cast</span><span>
</span><span id="line-2133"></span><span class="hs-comment">-- $type_cast</span><span>
</span><span id="line-2134"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2135"></span><span class="hs-comment">-- Performs a conversion from a memref with scalar element to a memref with a</span><span>
</span><span id="line-2136"></span><span class="hs-comment">-- *single* vector element, copying the shape of the memref to the vector. This</span><span>
</span><span id="line-2137"></span><span class="hs-comment">-- is the minimal viable operation that is required to makeke</span><span>
</span><span id="line-2138"></span><span class="hs-comment">-- super-vectorization operational. It can be seen as a special case of the</span><span>
</span><span id="line-2139"></span><span class="hs-comment">-- @view@ operation but scoped in the super-vectorization context.</span><span>
</span><span id="line-2140"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2141"></span><span class="hs-comment">-- Syntax:</span><span>
</span><span id="line-2142"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2143"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2144"></span><span class="hs-comment">-- operation ::= @vector.type_cast@ ssa-use : memref-type to memref-type</span><span>
</span><span id="line-2145"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2146"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2147"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-2148"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2149"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2150"></span><span class="hs-comment">-- %A  = memref.alloc() : memref\&lt;5x4x3xf32&gt;</span><span>
</span><span id="line-2151"></span><span class="hs-comment">-- %VA = vector.type_cast %A : memref\&lt;5x4x3xf32&gt; to memref\&lt;vector\&lt;5x4x3xf32&gt;&gt;</span><span>
</span><span id="line-2152"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2153"></span><span class="hs-comment">--   </span><span>
</span><span id="line-2154"></span><span>
</span><span id="line-2155"></span><span class="hs-comment">-- | A pattern for @vector.type_cast@.</span><span>
</span><span id="line-2156"></span><span id="local-6989586621679447564"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#TypeCast"><span class="hs-identifier hs-type">TypeCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447564"><span class="hs-identifier hs-type">operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447564"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-2157"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bTypeCast"><span id="%24mTypeCast"><span id="TypeCast"><span class="annot"><span class="annottext">$bTypeCast :: Location -&gt; Type -&gt; operand -&gt; AbstractOperation operand
$mTypeCast :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; Type -&gt; operand -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bTypeCast"><span class="hs-identifier hs-var hs-var hs-var">TypeCast</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447560"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447559"><span class="hs-identifier hs-type">ty0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447558"><span class="hs-identifier hs-type">memref_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2158"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.type_cast&quot;</span></span><span>
</span><span id="line-2159"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447560"><span class="annot"><a href="#local-6989586621679447560"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-2160"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447559"><span class="annot"><a href="#local-6989586621679447559"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2161"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679447558"><span class="annot"><a href="#local-6989586621679447558"><span class="hs-identifier hs-var">memref_</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2162"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2163"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2164"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2165"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-2166"></span><span>
</span><span id="line-2167"></span><span class="hs-comment">-- | A builder for @vector.type_cast@.</span><span>
</span><span id="line-2168"></span><span id="local-6989586621679447557"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#type_cast"><span class="hs-identifier hs-type">type_cast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-2169"></span><span id="type_cast"><span class="annot"><span class="annottext">type_cast :: Type -&gt; Value -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#type_cast"><span class="hs-identifier hs-var hs-var">type_cast</span></a></span></span><span> </span><span id="local-6989586621679447555"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447555"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447554"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447554"><span class="hs-identifier hs-var">memref_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2170"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2171"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.type_cast&quot;</span></span><span>
</span><span id="line-2172"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-2173"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679447555"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2174"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447554"><span class="hs-identifier hs-var">memref_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2175"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2176"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2177"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2178"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2179"></span><span>
</span><span id="line-2180"></span><span class="hs-comment">-- * warp_execute_on_lane_0</span><span>
</span><span id="line-2181"></span><span class="hs-comment">-- $warp_execute_on_lane_0</span><span>
</span><span id="line-2182"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2183"></span><span class="hs-comment">-- @warp_execute_on_lane_0@ is an operation used to bridge the gap between</span><span>
</span><span id="line-2184"></span><span class="hs-comment">-- vector programming and SPMD programming model like GPU SIMT. It allows to</span><span>
</span><span id="line-2185"></span><span class="hs-comment">-- trivially convert a region of vector code meant to run on a multiple threads</span><span>
</span><span id="line-2186"></span><span class="hs-comment">-- into a valid SPMD region and then allows incremental transformation to</span><span>
</span><span id="line-2187"></span><span class="hs-comment">-- distribute vector operations on the threads.</span><span>
</span><span id="line-2188"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2189"></span><span class="hs-comment">-- Any code present in the region would only be executed on first thread/lane</span><span>
</span><span id="line-2190"></span><span class="hs-comment">-- based on the @laneid@ operand. The @laneid@ operand is an integer ID between</span><span>
</span><span id="line-2191"></span><span class="hs-comment">-- [0, @warp_size@). The @warp_size@ attribute indicates the number of lanes in</span><span>
</span><span id="line-2192"></span><span class="hs-comment">-- a warp.</span><span>
</span><span id="line-2193"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2194"></span><span class="hs-comment">-- Operands are vector values distributed on all lanes that may be used by</span><span>
</span><span id="line-2195"></span><span class="hs-comment">-- the single lane execution. The matching region argument is a vector of all</span><span>
</span><span id="line-2196"></span><span class="hs-comment">-- the values of those lanes available to the single active lane. The</span><span>
</span><span id="line-2197"></span><span class="hs-comment">-- distributed dimension is implicit based on the shape of the operand and</span><span>
</span><span id="line-2198"></span><span class="hs-comment">-- argument. the properties of the distribution may be described by extra</span><span>
</span><span id="line-2199"></span><span class="hs-comment">-- attributes (e.g. affine map).</span><span>
</span><span id="line-2200"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2201"></span><span class="hs-comment">-- Return values are distributed on all lanes using laneId as index. The</span><span>
</span><span id="line-2202"></span><span class="hs-comment">-- vector is distributed based on the shape ratio between the vector type of</span><span>
</span><span id="line-2203"></span><span class="hs-comment">-- the yield and the result type.</span><span>
</span><span id="line-2204"></span><span class="hs-comment">-- If the shapes are the same this means the value is broadcasted to all lanes.</span><span>
</span><span id="line-2205"></span><span class="hs-comment">-- In the future the distribution can be made more explicit using affine_maps</span><span>
</span><span id="line-2206"></span><span class="hs-comment">-- and will support having multiple Ids.</span><span>
</span><span id="line-2207"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2208"></span><span class="hs-comment">-- Therefore the @warp_execute_on_lane_0@ operations allow to implicitly copy</span><span>
</span><span id="line-2209"></span><span class="hs-comment">-- between lane0 and the lanes of the warp. When distributing a vector</span><span>
</span><span id="line-2210"></span><span class="hs-comment">-- from lane0 to all the lanes, the data are distributed in a block cyclic way.</span><span>
</span><span id="line-2211"></span><span class="hs-comment">-- For exemple @vector\&lt;64xf32&gt;@ gets distributed on 32 threads and map to</span><span>
</span><span id="line-2212"></span><span class="hs-comment">-- @vector\&lt;2xf32&gt;@ where thread 0 contains vector[0] and vector[1].</span><span>
</span><span id="line-2213"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2214"></span><span class="hs-comment">-- During lowering values passed as operands and return value need to be</span><span>
</span><span id="line-2215"></span><span class="hs-comment">-- visible to different lanes within the warp. This would usually be done by</span><span>
</span><span id="line-2216"></span><span class="hs-comment">-- going through memory.</span><span>
</span><span id="line-2217"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2218"></span><span class="hs-comment">-- The region is *not* isolated from above. For values coming from the parent</span><span>
</span><span id="line-2219"></span><span class="hs-comment">-- region not going through operands only the lane 0 value will be accesible so</span><span>
</span><span id="line-2220"></span><span class="hs-comment">-- it generally only make sense for uniform values.</span><span>
</span><span id="line-2221"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2222"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-2223"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2224"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2225"></span><span class="hs-comment">-- vector.warp_execute_on_lane_0 (%laneid)[32] {</span><span>
</span><span id="line-2226"></span><span class="hs-comment">--   // Serial code running only on thread/lane 0.</span><span>
</span><span id="line-2227"></span><span class="hs-comment">--   ...</span><span>
</span><span id="line-2228"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-2229"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2230"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2231"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2232"></span><span class="hs-comment">-- This may be lowered to an scf.if region as below:</span><span>
</span><span id="line-2233"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2234"></span><span class="hs-comment">--   // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2235"></span><span class="hs-comment">--   %cnd = arith.cmpi eq, %laneid, %c0 : index</span><span>
</span><span id="line-2236"></span><span class="hs-comment">--   scf.if %cnd {</span><span>
</span><span id="line-2237"></span><span class="hs-comment">--     // Serial code running only on thread/lane 0.</span><span>
</span><span id="line-2238"></span><span class="hs-comment">--     ...</span><span>
</span><span id="line-2239"></span><span class="hs-comment">--   }</span><span>
</span><span id="line-2240"></span><span class="hs-comment">--   // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2241"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2242"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2243"></span><span class="hs-comment">-- When the region has operands and/or return values:</span><span>
</span><span id="line-2244"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2245"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2246"></span><span class="hs-comment">-- %0 = vector.warp_execute_on_lane_0(%laneid)[32]</span><span>
</span><span id="line-2247"></span><span class="hs-comment">-- args(%v0 : vector\&lt;4xi32&gt;) -&gt; (vector\&lt;1xf32&gt;) {</span><span>
</span><span id="line-2248"></span><span class="hs-comment">-- ^bb0(%arg0 : vector\&lt;128xi32&gt;) :</span><span>
</span><span id="line-2249"></span><span class="hs-comment">--   // Serial code running only on thread/lane 0.</span><span>
</span><span id="line-2250"></span><span class="hs-comment">--   ...</span><span>
</span><span id="line-2251"></span><span class="hs-comment">--   vector.yield %1 : vector\&lt;32xf32&gt;</span><span>
</span><span id="line-2252"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-2253"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2254"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2255"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2256"></span><span class="hs-comment">-- values at the region boundary would go through memory:</span><span>
</span><span id="line-2257"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2258"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2259"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-2260"></span><span class="hs-comment">-- // Store the data from each thread into memory and Synchronization.</span><span>
</span><span id="line-2261"></span><span class="hs-comment">-- %tmp0 = memreg.alloc() : memref\&lt;128xf32&gt;</span><span>
</span><span id="line-2262"></span><span class="hs-comment">-- %tmp1 = memreg.alloc() : memref\&lt;32xf32&gt;</span><span>
</span><span id="line-2263"></span><span class="hs-comment">-- %cnd = arith.cmpi eq, %laneid, %c0 : index</span><span>
</span><span id="line-2264"></span><span class="hs-comment">-- vector.store %v0, %tmp0[%laneid] : memref\&lt;128xf32&gt;, vector\&lt;4xf32&gt;</span><span>
</span><span id="line-2265"></span><span class="hs-comment">-- some_synchronization_primitive</span><span>
</span><span id="line-2266"></span><span class="hs-comment">-- scf.if %cnd {</span><span>
</span><span id="line-2267"></span><span class="hs-comment">--   // Serialized code running only on thread 0.</span><span>
</span><span id="line-2268"></span><span class="hs-comment">--   // Load the data from all the threads into a register from thread 0. This</span><span>
</span><span id="line-2269"></span><span class="hs-comment">--   // allow threads 0 to access data from all the threads.</span><span>
</span><span id="line-2270"></span><span class="hs-comment">--   %arg0 = vector.load %tmp0[%c0] : memref\&lt;128xf32&gt;, vector\&lt;128xf32&gt;</span><span>
</span><span id="line-2271"></span><span class="hs-comment">--   ...</span><span>
</span><span id="line-2272"></span><span class="hs-comment">--   // Store the data from thread 0 into memory.</span><span>
</span><span id="line-2273"></span><span class="hs-comment">--   vector.store %1, %tmp1[%c0] : memref\&lt;32xf32&gt;, vector\&lt;32xf32&gt;</span><span>
</span><span id="line-2274"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-2275"></span><span class="hs-comment">-- // Synchronization and load the data in a block cyclic way so that the</span><span>
</span><span id="line-2276"></span><span class="hs-comment">-- // vector is distributed on all threads.</span><span>
</span><span id="line-2277"></span><span class="hs-comment">-- some_synchronization_primitive</span><span>
</span><span id="line-2278"></span><span class="hs-comment">-- %0 = vector.load %tmp1[%laneid] : memref\&lt;32xf32&gt;, vector\&lt;32xf32&gt;</span><span>
</span><span id="line-2279"></span><span class="hs-comment">-- // Execute in parallel on all threads/lanes.</span><span>
</span><span id="line-2280"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-2281"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2282"></span><span class="hs-comment">--   </span><span>
</span><span id="line-2283"></span><span>
</span><span id="line-2284"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalWarpExecuteOnLane0OpAttributes"><span class="hs-identifier hs-type">InternalWarpExecuteOnLane0OpAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#NamedAttributes"><span class="hs-identifier hs-type">NamedAttributes</span></a></span><span>
</span><span id="line-2285"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bInternalWarpExecuteOnLane0OpAttributes"><span id="%24mInternalWarpExecuteOnLane0OpAttributes"><span id="InternalWarpExecuteOnLane0OpAttributes"><span class="annot"><span class="annottext">$bInternalWarpExecuteOnLane0OpAttributes :: Int -&gt; Map Name Attribute
$mInternalWarpExecuteOnLane0OpAttributes :: forall r. Map Name Attribute -&gt; (Int -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bInternalWarpExecuteOnLane0OpAttributes"><span class="hs-identifier hs-var hs-var hs-var hs-var">InternalWarpExecuteOnLane0OpAttributes</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447550"><span class="hs-identifier hs-type">warp_size_</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679447549"><span class="annot"><a href="#local-6989586621679447549"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;warp_size&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679447549"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-type">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-type">IntegerType</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-type">Signless</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679447550"><span class="annot"><a href="#local-6989586621679447550"><span class="hs-identifier hs-var">warp_size_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2286"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalWarpExecuteOnLane0OpAttributes"><span class="hs-identifier hs-var">InternalWarpExecuteOnLane0OpAttributes</span></a></span><span> </span><span id="local-6989586621679447548"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447548"><span class="hs-identifier hs-var">warp_size_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Attribute)] -&gt; Map Name Attribute
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Attribute)] -&gt; Map Name Attribute)
-&gt; [(Name, Attribute)] -&gt; Map Name Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;warp_size&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int -&gt; Attribute
</span><a href="MLIR.AST.html#IntegerAttr"><span class="hs-identifier hs-var">IntegerAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signedness -&gt; UInt -&gt; Type
</span><a href="MLIR.AST.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="MLIR.AST.html#Signless"><span class="hs-identifier hs-var">Signless</span></a></span><span> </span><span class="annot"><span class="annottext">UInt
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447548"><span class="hs-identifier hs-var">warp_size_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2287"></span><span>
</span><span id="line-2288"></span><span class="hs-comment">-- | A builder for @vector.warp_execute_on_lane_0@.</span><span>
</span><span id="line-2289"></span><span id="local-6989586621679447547"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#warp_execute_on_lane_0"><span class="hs-identifier hs-type">warp_execute_on_lane_0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447547"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#RegionBuilderT"><span class="hs-identifier hs-type">RegionBuilderT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447547"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447547"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span></span><span>
</span><span id="line-2290"></span><span id="warp_execute_on_lane_0"><span class="annot"><span class="annottext">warp_execute_on_lane_0 :: [Type] -&gt; Value -&gt; [Value] -&gt; Int -&gt; RegionBuilderT m () -&gt; m Value
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#warp_execute_on_lane_0"><span class="hs-identifier hs-var hs-var">warp_execute_on_lane_0</span></a></span></span><span> </span><span id="local-6989586621679447545"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679447545"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span id="local-6989586621679447544"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447544"><span class="hs-identifier hs-var">laneid_</span></a></span></span><span> </span><span id="local-6989586621679447543"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447543"><span class="hs-identifier hs-var">args_</span></a></span></span><span> </span><span id="local-6989586621679447542"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447542"><span class="hs-identifier hs-var">warp_size_</span></a></span></span><span> </span><span id="local-6989586621679447541"><span class="annot"><span class="annottext">RegionBuilderT m ()
</span><a href="#local-6989586621679447541"><span class="hs-identifier hs-var">warpRegion_Builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2291"></span><span>  </span><span id="local-6989586621679447540"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679447540"><span class="hs-identifier hs-var">warpRegion_</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RegionBuilderT m () -&gt; m Region
forall (m :: * -&gt; *). Monad m =&gt; RegionBuilderT m () -&gt; m Region
</span><a href="MLIR.AST.Builder.html#buildRegion"><span class="hs-identifier hs-var">AST.buildRegion</span></a></span><span> </span><span class="annot"><span class="annottext">RegionBuilderT m ()
</span><a href="#local-6989586621679447541"><span class="hs-identifier hs-var">warpRegion_Builder</span></a></span><span>
</span><span id="line-2292"></span><span>  </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">Control.Monad.liftM</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">Prelude.head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2293"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.warp_execute_on_lane_0&quot;</span></span><span>
</span><span id="line-2294"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-2295"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679447545"><span class="hs-identifier hs-var">ty0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2296"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Name
</span><a href="MLIR.AST.Builder.html#operand"><span class="hs-identifier hs-var">AST.operand</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679447544"><span class="hs-identifier hs-var">laneid_</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447543"><span class="hs-identifier hs-var">args_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2297"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621679447540"><span class="hs-identifier hs-var">warpRegion_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2298"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2299"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Map Name Attribute
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#InternalWarpExecuteOnLane0OpAttributes"><span class="hs-identifier hs-var">InternalWarpExecuteOnLane0OpAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679447542"><span class="hs-identifier hs-var">warp_size_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2300"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2301"></span><span>
</span><span id="line-2302"></span><span class="hs-comment">-- * yield</span><span>
</span><span id="line-2303"></span><span class="hs-comment">-- $yield</span><span>
</span><span id="line-2304"></span><span class="hs-comment">-- </span><span>
</span><span id="line-2305"></span><span class="hs-comment">-- \&quot;vector.yield\&quot; yields an SSA value from the Vector dialect op region and</span><span>
</span><span id="line-2306"></span><span class="hs-comment">-- terminates the regions. The semantics of how the values are yielded is</span><span>
</span><span id="line-2307"></span><span class="hs-comment">-- defined by the parent operation.</span><span>
</span><span id="line-2308"></span><span class="hs-comment">-- If \&quot;vector.yield\&quot; has any operands, the operands must correspond to the</span><span>
</span><span id="line-2309"></span><span class="hs-comment">-- parent operation\'s results.</span><span>
</span><span id="line-2310"></span><span class="hs-comment">-- If the parent operation defines no value the vector.yield may be omitted</span><span>
</span><span id="line-2311"></span><span class="hs-comment">-- when printing the region.</span><span>
</span><span id="line-2312"></span><span class="hs-comment">--   </span><span>
</span><span id="line-2313"></span><span>
</span><span id="line-2314"></span><span class="hs-comment">-- | A pattern for @vector.yield@.</span><span>
</span><span id="line-2315"></span><span id="local-6989586621679448014"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#Yield"><span class="hs-identifier hs-type">Yield</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679448014"><span class="hs-identifier hs-type">operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.html#AbstractOperation"><span class="hs-identifier hs-type">AbstractOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679448014"><span class="hs-identifier hs-type">operand</span></a></span></span><span>
</span><span id="line-2316"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bYield"><span id="%24mYield"><span id="Yield"><span class="annot"><span class="annottext">$bYield :: Location -&gt; [operand] -&gt; AbstractOperation operand
$mYield :: forall r operand.
AbstractOperation operand
-&gt; (Location -&gt; [operand] -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#%24bYield"><span class="hs-identifier hs-var hs-var hs-var">Yield</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679447535"><span class="hs-identifier hs-type">loc</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679447534"><span class="hs-identifier hs-type">operands_</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2317"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;vector.yield&quot;</span></span><span>
</span><span id="line-2318"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447535"><span class="annot"><a href="#local-6989586621679447535"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-2319"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-type">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2320"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679447534"><span class="annot"><a href="#local-6989586621679447534"><span class="hs-identifier hs-var">operands_</span></a></span></span><span>
</span><span id="line-2321"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2322"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2323"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-type">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2324"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-2325"></span><span>
</span><span id="line-2326"></span><span class="hs-comment">-- | A builder for @vector.yield@.</span><span>
</span><span id="line-2327"></span><span id="local-6989586621679447533"><span class="annot"><a href="MLIR.AST.Dialect.Generated.Vector.html#yield"><span class="hs-identifier hs-type">yield</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#MonadBlockBuilder"><span class="hs-identifier hs-type">MonadBlockBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679447533"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="MLIR.AST.Builder.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679447533"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="MLIR.AST.Builder.html#EndOfBlock"><span class="hs-identifier hs-type">EndOfBlock</span></a></span></span><span>
</span><span id="line-2328"></span><span id="yield"><span class="annot"><span class="annottext">yield :: [Value] -&gt; m EndOfBlock
</span><a href="MLIR.AST.Dialect.Generated.Vector.html#yield"><span class="hs-identifier hs-var hs-var">yield</span></a></span></span><span>  </span><span id="local-6989586621679447531"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447531"><span class="hs-identifier hs-var">operands_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2329"></span><span>  </span><span class="annot"><span class="annottext">m [Value] -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">Control.Monad.void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation -&gt; m [Value]
forall (m :: * -&gt; *). MonadBlockBuilder m =&gt; Operation -&gt; m [Value]
</span><a href="MLIR.AST.Builder.html#emitOp"><span class="hs-identifier hs-var">AST.emitOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operation :: forall operand.
Name
-&gt; Location
-&gt; ResultTypes
-&gt; [operand]
-&gt; [Region]
-&gt; [Name]
-&gt; Map Name Attribute
-&gt; AbstractOperation operand
</span><a href="MLIR.AST.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-2330"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">opName :: Name
</span><a href="MLIR.AST.html#opName"><span class="hs-identifier hs-var">opName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;vector.yield&quot;</span></span><span>
</span><span id="line-2331"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opLocation :: Location
</span><a href="MLIR.AST.html#opLocation"><span class="hs-identifier hs-var">opLocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="MLIR.AST.html#UnknownLocation"><span class="hs-identifier hs-var">UnknownLocation</span></a></span><span>
</span><span id="line-2332"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opResultTypes :: ResultTypes
</span><a href="MLIR.AST.html#opResultTypes"><span class="hs-identifier hs-var">opResultTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; ResultTypes
</span><a href="MLIR.AST.html#Explicit"><span class="hs-identifier hs-var">Explicit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2333"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opOperands :: [Name]
</span><a href="MLIR.AST.html#opOperands"><span class="hs-identifier hs-var">opOperands</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [Name]
</span><a href="MLIR.AST.Builder.html#operands"><span class="hs-identifier hs-var">AST.operands</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679447531"><span class="hs-identifier hs-var">operands_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2334"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opRegions :: [Region]
</span><a href="MLIR.AST.html#opRegions"><span class="hs-identifier hs-var">opRegions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2335"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opSuccessors :: [Name]
</span><a href="MLIR.AST.html#opSuccessors"><span class="hs-identifier hs-var">opSuccessors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2336"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">opAttributes :: Map Name Attribute
</span><a href="MLIR.AST.html#opAttributes"><span class="hs-identifier hs-var">opAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Attribute
</span><a href="MLIR.AST.html#NoAttrs"><span class="hs-identifier hs-var">NoAttrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2337"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2338"></span><span>  </span><span class="annot"><span class="annottext">m EndOfBlock
forall (m :: * -&gt; *). Monad m =&gt; m EndOfBlock
</span><a href="MLIR.AST.Builder.html#terminateBlock"><span class="hs-identifier hs-var">AST.terminateBlock</span></a></span><span>
</span><span id="line-2339"></span></pre></body></html>